{\rtf1\ansi\ansicpg1252\cocoartf2580
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica-Bold;\f1\fswiss\fcharset0 Helvetica;\f2\fnil\fcharset0 Menlo-Bold;
\f3\fnil\fcharset0 Menlo-Regular;\f4\fmodern\fcharset0 Courier;\f5\fnil\fcharset0 Verdana;
\f6\fnil\fcharset0 Verdana-Italic;\f7\fnil\fcharset0 HelveticaNeue;}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;\red230\green230\blue230;\red0\green0\blue0;
\red236\green186\blue254;\red255\green255\blue10;\red0\green0\blue0;\red27\green31\blue35;\red47\green189\blue29;
\red15\green15\blue15;\red251\green2\blue7;\red255\green255\blue255;\red38\green38\blue38;\red234\green235\blue236;
\red27\green31\blue34;\red4\green26\blue165;\red0\green0\blue0;\red46\green84\blue140;\red28\green28\blue28;
\red26\green26\blue26;\red10\green82\blue135;\red230\green230\blue230;}
{\*\expandedcolortbl;;\csgray\c0;\csgray\c92143;\cssrgb\c0\c0\c0;
\cssrgb\c94438\c78969\c99727;\cssrgb\c99942\c98555\c0;\csgray\c0\c0;\cssrgb\c14118\c16078\c18431;\cssrgb\c20011\c76928\c14710;
\cssrgb\c7059\c7059\c7059;\cssrgb\c100000\c14913\c0;\cssrgb\c100000\c100000\c100000;\cssrgb\c20000\c20000\c20000;\cssrgb\c93333\c93725\c94118;
\cssrgb\c14118\c16078\c18039;\cssrgb\c1569\c19216\c70588;\cssrgb\c0\c0\c0\c87059;\cssrgb\c23137\c41176\c61961;\cssrgb\c14510\c14510\c14510;
\cssrgb\c13333\c13333\c13333;\cssrgb\c0\c40000\c60000;\csgray\c92143;}
{\*\listtable{\list\listtemplateid1\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid1}}
{\*\listoverridetable{\listoverride\listid1\listoverridecount0\ls1}}
\margl1440\margr1440\vieww24500\viewh8640\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\b\fs36 \cf0 Importing the data
\fs26   \
\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\
Getting the Metadata into Poseidon:
\f1\b0 \

\fs24 -Downloaded as .csv from GoogleDrive\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf2 \cb3 \CocoaLigature0 \
scp /Users/sabrinaelkassas/Downloads/SRA_accessions_metzyme_16S_18S_metaT.xlsx\\ -\\ Sheet1.csv selkassas@poseidon.whoi.edu:/vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/Metadata\
\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\fs26 \cf0 \cb1 \CocoaLigature1 \

\f0\b Removing the metaT files we didn\'92t need: \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b0\fs22 \cf4 \cb3 \CocoaLigature0 \

\fs24 rm -v !("30B8Z_S11_001.unpaired_trimmed_*.fna"|"30B90_S12_001.unpaired_trimmed_*.fna"|"30B91_S28_001.unpaired_trimmed_*.fna")
\fs22 \
\cf2 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\fs26 \cf0 \cb1 \CocoaLigature1 \

\f0\b Getting the 16S into Poseidon from GoogleDrive:\
-Downloaded (~13MB) onto local computer first\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b0\fs22 \cf2 \cb3 \CocoaLigature0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 scp -r /Users/sabrinaelkassas/Downloads/16S selkassas@poseidon.whoi.edu:/vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads
\fs22 \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs26 \cf0 \cb1 \CocoaLigature1 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \

\fs36 Quality Controlling the data
\fs26 \
\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \cb5 Programs = trim_galore + fastqc\cb1 \
\
Metatranscriptome QC - FastQC on default settings.\
\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f1\b0 \cf0 #files are only a maximum of 32MB, so ran this on srun\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3 \CocoaLigature0 \
srun -p scavenger --time=04:00:00 --ntasks-per-node 2 --pty bash\cf0 \CocoaLigature1  
\f0\b \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f1\b0 \cf0 conda activate qc-trim\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf2 \CocoaLigature0 cd /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads\cf0 \CocoaLigature1 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 fastqc .fna\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\b \cf0 \
\cb6 NOTE: this did not work. Cannot QC .fna files\cb3 \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 \cb7 \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 \cb1 16S Trimming and FastQC on default settings\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f1\b0 \cf0 #files are only a maximum of 13MB, so ran this on srun
\f0\b \
\pard\pardeftab720\partightenfactor0

\f1\b0 \cf4 \cb3 \CocoaLigature0 \
srun -p scavenger --time=04:00:00 --ntasks-per-node 2 --pty bash\cf0 \CocoaLigature1  
\fs24 \cf2 \CocoaLigature0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
conda activate qc-trim\
\pard\pardeftab720\sl380\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 #Station 9 380m\
trim_galore --paired --fastqc 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI010_16S_AGAGTCAC_R1.fastq.gz 
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI010_16S_AGAGTCAC_R2.fastq.gz\
#Station 9 70m\

\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 trim_galore --paired --fastqc 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI020_16S_TCGACGAG_R1.fastq.gz WHOI020_16S_TCGACGAG_R2.fastq.gz\
#Station 9 40m\

\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 trim_galore --paired --fastqc 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI040_16S_TCGACGAG_R1.fastq.gz WHOI040_16S_TCGACGAG_R2.fastq.gz
\fs24 \cf8 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b \cf0 \kerning1\expnd0\expndtw0 \

\fs26 \cf2 \cb1 \CocoaLigature0 \
How trimmed 16s compares in size to untrimmed:
\f1\b0\fs22 \

\fs24 \cf0 \cb7 \CocoaLigature1 \

\fs22 \cf2 \cb1 \CocoaLigature0 raw total 14M\
-rwx------ 1 selkassas sg-envbio-mgr 2.9M Oct 20 21:18 \cf9 WHOI010_16S_AGAGTCAC_R2.fastq.gz\cf2 \
-rwx------ 1 selkassas sg-envbio-mgr 2.2M Oct 20 21:18 \cf9 WHOI020_16S_TCGACGAG_R1.fastq.gz\cf2 \
-rwx------ 1 selkassas sg-envbio-mgr 2.2M Oct 20 21:18 \cf9 WHOI040_16S_TCGACGAG_R2.fastq.gz\cf2 \
-rwx------ 1 selkassas sg-envbio-mgr 3.2M Oct 20 21:18 \cf9 WHOI020_16S_TCGACGAG_R2.fastq.gz\cf2 \
-rwx------ 1 selkassas sg-envbio-mgr 1.9M Oct 20 21:18 \cf9 WHOI010_16S_AGAGTCAC_R1.fastq.gz\cf2 \
-rwx------ 1 selkassas sg-envbio-mgr 1.5M Oct 20 21:18 \cf9 WHOI040_16S_TCGACGAG_R1.fastq.gz\
\
\cf2 trimmed total 13M\
-rwx------ 1 selkassas sg-envbio-mgr 2.0M Oct 20 21:32 \cf9 WHOI040_16S_TCGACGAG_R2_val_2.fq.gz\cf2 \
-rwx------ 1 selkassas sg-envbio-mgr 1.4M Oct 20 21:32 \cf9 WHOI040_16S_TCGACGAG_R1_val_1.fq.gz\cf2 \
-rwx------ 1 selkassas sg-envbio-mgr 2.9M Oct 20 21:32 \cf9 WHOI020_16S_TCGACGAG_R2_val_2.fq.gz\cf2 \
-rwx------ 1 selkassas sg-envbio-mgr 2.1M Oct 20 21:32 \cf9 WHOI020_16S_TCGACGAG_R1_val_1.fq.gz\cf2 \
-rwx------ 1 selkassas sg-envbio-mgr 2.6M Oct 20 21:31 \cf9 WHOI010_16S_AGAGTCAC_R2_val_2.fq.gz\cf2 \
-rwx------ 1 selkassas sg-envbio-mgr 1.9M Oct 20 21:31 \cf9 WHOI010_16S_AGAGTCAC_R1_val_1.fq.gz\

\fs24 \cf0 \cb7 \CocoaLigature1 \
\cb3 #Viewed the fastqc reports using:\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs22 \cf2 \CocoaLigature0 scp -r selkassas@poseidon.whoi.edu:/vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/output /Users/sabrinaelkassas/Desktop/\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 \cf0 \CocoaLigature1 \

\fs22 \cf2 \cb1 \CocoaLigature0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs24 16S fastqc stats 40m R1 and R2
\f1\b0\fs22 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\fs24 \cf0 \cb7 \CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b \cf0 \
16S fastqc stats 70m R1 and R2
\f1\b0 \cb1 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b \cf0 \cb7 \
16S fastqc stats 380m R1 and R2\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f1\b0 \cf0 \cb1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b \cf0 \cb7 \
18S Trimming and FastQC on default settings 
\fs26 \cb1 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f1\b0 \cf0 #files are only a maximum of 32MB, so ran this on srun\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf4 \cb3 \CocoaLigature0 \
\pard\pardeftab720\partightenfactor0
\cf4 srun -p scavenger --time=04:00:00 --ntasks-per-node 2 --pty bash\cf0 \CocoaLigature1  
\fs24 \cf2 \CocoaLigature0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
conda activate qc-trim\
\pard\pardeftab720\sl380\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 #Station 9 380m\
trim_galore \'97paired \'97q\'97 25 fastqc 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI010-V9_S94_L001_R1_001.fastq WHOI010-V9_S94_L001_R2_001.fastq\
#Station 9 70m\

\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 trim_galore --paired --fastqc 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI040-V9_S124_L001_R1_001.fastq WHOI040-V9_S124_L001_R2_001.fastq\
#Station 9 40m\

\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 trim_galore --paired \'97,fastqc 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI021-V9_S105_L001_R1_001.fastq WHOI021-V9_S105_L001_R2_001.fastq
\fs24 \cf8 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b \cf0 \kerning1\expnd0\expndtw0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 \cb7 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs26 \cf2 \cb1 \CocoaLigature0 How trimmed 18s compares in size to untrimmed:\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 \cf0 \cb7 \CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b0\fs22 \cf2 \cb1 \CocoaLigature0 raw total 11M\
-rwx------ 1 kaabbott sg-envbio-mgr 2.0M Oct 14 15:37 \cf9 WHOI021-V9_S105_L001_R1_001.fastq\cf2 \
-rwx------ 1 kaabbott sg-envbio-mgr 1.9M Oct 14 15:37 \cf9 WHOI040-V9_S124_L001_R2_001.fastq\cf2 \
-rwx------ 1 kaabbott sg-envbio-mgr 1.2M Oct 14 15:37 \cf9 WHOI010-V9_S94_L001_R1_001.fastq\cf2 \
-rwx------ 1 kaabbott sg-envbio-mgr 2.0M Oct 14 15:37 \cf9 WHOI021-V9_S105_L001_R2_001.fastq\cf2 \
-rwx------ 1 kaabbott sg-envbio-mgr 1.9M Oct 14 15:37 \cf9 WHOI040-V9_S124_L001_R1_001.fastq\cf2 \
-rwx------ 1 kaabbott sg-envbio-mgr 1.2M Oct 14 15:37 \cf9 WHOI010-V9_S94_L001_R2_001.fastq\cf2 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs24 \cf0 \cb7 \CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b0\fs22 \cf2 \cb1 \CocoaLigature0 total 11M\
-rwx------ 1 selkassas sg-envbio-mgr 2.0M Oct 20 21:51 \cf9 WHOI021-V9_S105_L001_R2_001_val_2.fq\cf2 \
-rwx------ 1 selkassas sg-envbio-mgr 2.0M Oct 20 21:51 \cf9 WHOI021-V9_S105_L001_R1_001_val_1.fq\cf2 \
-rwx------ 1 selkassas sg-envbio-mgr 1.9M Oct 20 21:51 \cf9 WHOI040-V9_S124_L001_R2_001_val_2.fq\cf2 \
-rwx------ 1 selkassas sg-envbio-mgr 1.9M Oct 20 21:51 \cf9 WHOI040-V9_S124_L001_R1_001_val_1.fq\cf2 \
-rwx------ 1 selkassas sg-envbio-mgr 1.2M Oct 20 21:51 \cf9 WHOI010-V9_S94_L001_R2_001_val_2.fq\cf2 \
-rwx------ 1 selkassas sg-envbio-mgr 1.2M Oct 20 21:51 \cf9 WHOI010-V9_S94_L001_R1_001_val_1.fq\
\

\fs24 \cf0 \cb3 \CocoaLigature1 #Viewed the fastqc reports using:\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs22 \cf2 \CocoaLigature0 scp -r selkassas@poseidon.whoi.edu:/vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/output /Users/sabrinaelkassas/Desktop/\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 \cf0 \CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b \cf0 \cb7 \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf2 \cb1 \CocoaLigature0 18S fastqc stats 40m R1 and R2\cf0 \cb7 \CocoaLigature1 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 \
\
18S fastqc stats 70m R1 and R2\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 \
\
\
18S fastqc stats 380m R1 and R2\

\f1\b0 \cb1 \

\f0\b \cb7 \
-quality stats for 18s are very bad. Running through trim-galore again with a -q score of 25. \
NOTE: I tried with different length and quality cutoffs (\'97length 60 and -length 80 and with -q scores of 25 and 30) but did not see much of an improvement with the data. Left on default and continued with the pipeline\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs36 \cf0 \cb1 Removing rRNA reads from MetaT with riboPicker v.0.4.3
\fs26 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 \cb7 riboPicker is a web-based platform. \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b0 \cf0 -databases chosen to map rRNA to: default [\cf10 \expnd0\expndtw0\kerning0
SILVA Small subunit reference database (16S/18S) & SILVA Large subunit reference database (23S/28S)]\
-so, had to get MetaT sequences off of Poseidon and onto my local computer to make sure I could upload it to the riboPicker tool.\

\fs28 \
\cf11 -riboPicker online is deprecated. Will work with \cb12 the version on the terminal of my local computer (http://ribopicker.sourceforge.net).\cb7 \

\fs24 \cf10 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\b \cf0 \kerning1\expnd0\expndtw0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs36 \cf0 \cb1 \
\
Merging forward and reverse MetaT reads then Removing rRNA reads from MetaT with SortMeRNA 4.2.0
\fs26 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\fs28 \cf4 \cb5 Programs: BBMap 
\f1\b0 \expnd0\expndtw0\kerning0
38.93
\f0\b \kerning1\expnd0\expndtw0 , Flash 
\f1\b0 \expnd0\expndtw0\kerning0
1.2.11
\f0\b \kerning1\expnd0\expndtw0 , SortMeRNA 4.2.0
\f2\fs24 \cf0 \cb7 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs26 \cf0 \
#Convert .fna files to .fasta \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f1\b0 \cf4 \cb3 \
mv
\f0\b  
\f3\b0\fs22 \CocoaLigature0 30B8Z_S11_001.unpaired_trimmed_1.fna 30B8Z_S11_001.unpaired_trimmed_1.fasta\
mv 30B8Z_S11_001.unpaired_trimmed_2.fna 30B8Z_S11_001.unpaired_trimmed_2.fasta\
\

\f0\b\fs26 \CocoaLigature1 mv 
\f3\b0\fs22 \CocoaLigature0 30B90_S12_001.unpaired_trimmed_1.fna 30B90_S12_001.unpaired_trimmed_1.fasta\
mv 30B90_S12_001.unpaired_trimmed_2.fna 30B90_S12_001.unpaired_trimmed_2.fasta\
\
mv 30B91_S28_001.unpaired_trimmed_1.fna 30B91_S28_001.unpaired_trimmed_1.fasta\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 mv 30B91_S28_001.unpaired_trimmed_2.fna 30B91_S28_001.unpaired_trimmed_2.fasta
\f0\b\fs26 \CocoaLigature1 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf4 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \cb7 \
use reformat.sh in BBmap to assign fake quality scores to .fasta files, which will then convert them to .fastq files. This will help running through Flash and SortMeRNA in the next two steps. \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \cb3 \
#Create the conda environment: \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f1\b0\fs24 \cf0 conda create --name bbmap\
conda activate bbmap\
\pard\pardeftab720\partightenfactor0
\cf13 \cb14 \expnd0\expndtw0\kerning0
conda install -c bioconda bbmap\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f3\fs22 \cf2 \cb3 \kerning1\expnd0\expndtw0 \CocoaLigature0 #environment location to later transfer the .yaml file to the project folder in poseidon: /vortexfs1/home/selkassas/.conda/envs/bbmap
\f0\b\fs26 \cf0 \CocoaLigature1 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \
#enter scavenger \
\pard\pardeftab720\partightenfactor0

\f1\b0 \cf4 \CocoaLigature0 srun -p scavenger --time=04:00:00 --ntasks-per-node 2 --pty bash\cf0 \CocoaLigature1  \

\f0\b \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 #BBmap code: \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f3\b0\fs22 \cf2 \CocoaLigature0 Usage:  reformat.sh in=<file> in2=<file2> out=<outfile> out2=<outfile2> qfake=30
\f1\fs24 \cf13 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\pardeftab720\sl320\partightenfactor0

\f0\b \cf13 #40m
\f1\b0 \
reformat.sh in=
\f3\fs22 \cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B8Z_S11_001.unpaired_trimmed_1.fasta in2=30B8Z_S11_001.unpaired_trimmed_2.fasta out=30B8Z_S11_001.unpaired_trimmed_1_40m.fastq out2=30B8Z_S11_001.unpaired_trimmed_2_40m.fastq qfake=30\

\f2\b #70m
\f3\b0 \

\f1\fs24 \cf13 \expnd0\expndtw0\kerning0
\CocoaLigature1 reformat.sh in=
\f3\fs22 \cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B90_S12_001.unpaired_trimmed_1.fasta in2=30B90_S12_001.unpaired_trimmed_2.fasta out=30B90_S12_001.unpaired_trimmed_1_70m.fastq out2=30B90_S12_001.unpaired_trimmed_2_70m.fastq qfake=30\
\pard\pardeftab720\sl320\partightenfactor0

\f0\b\fs24 \cf0 \CocoaLigature1 #380m\
\pard\pardeftab720\sl320\partightenfactor0

\f1\b0 \cf13 \expnd0\expndtw0\kerning0
reformat.sh in=
\f3\fs22 \cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B91_S28_001.unpaired_trimmed_1.fasta in2=30B91_S28_001.unpaired_trimmed_2.fasta out=30B91_S28_001.unpaired_trimmed_1_380m_.fastq out2=30B91_S28_001.unpaired_trimmed_2_380m.fastq qfake=30\
\pard\pardeftab720\sl320\partightenfactor0

\f0\b\fs26 \cf0 \CocoaLigature1 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \cb7 \
#BBMerge code to merge .fasta files\
\pard\pardeftab720\sl280\partightenfactor0

\f3\b0\fs24 \cf4 \cb12 \expnd0\expndtw0\kerning0
bbmerge.sh in1=<read1> in2=<read2> out=<merged reads> outu1=<unmerged1> outu2=<unmerged2>
\f0\b\fs26 \cf0 \cb7 \kerning1\expnd0\expndtw0 \
#40m\

\f1\b0\fs24 \cf13 \cb3 \expnd0\expndtw0\kerning0
bbmerge.sh in1=
\f3\fs22 \cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B8Z_S11_001.unpaired_trimmed_1.fasta in2=30B8Z_S11_001.unpaired_trimmed_2.fasta out=30B8Z_S11_merged_40m.fasta outu1=30B8Z_S11_001_unmerged1.fasta outu2=30B8Z_S11_001_unmerged2.fasta\
\

\fs36 FAILED - NO OVERLAP ON PAIRED READS
\fs22 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\b\fs26 \cf0 \cb7 \CocoaLigature1 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f2\fs24 \cf0 #Create the conda environment\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \cb3 \

\f3\b0 conda create --name sortmerna\
conda activate sortmerna\
conda install -c bioconda sortmerna\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\b\fs26 \cf0 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \cb7 \
#In the same environment, install Flash 
\f3\b0\fs24 \cf13 \expnd0\expndtw0\kerning0
1.2.11
\f0\b\fs26 \cf0 \kerning1\expnd0\expndtw0  to merge forward and reverse reads \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f3\b0\fs24 \cf13 \cb3 \expnd0\expndtw0\kerning0
conda install -c bioconda flash\
\

\f2\b #ran on default parameters: \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f3\b0\fs22 \cf2 \kerning1\expnd0\expndtw0 \CocoaLigature0  Parameters:\
[FLASH]     Min overlap:           10\
[FLASH]     Max overlap:           65\
[FLASH]     Max mismatch density:  0.250000\
[FLASH]     Allow "outie" pairs:   false\
[FLASH]     Cap mismatch quals:    false\
[FLASH]     Combiner threads:      36\
[FLASH]     Input format:          FASTQ, phred_offset=33\
[FLASH]     Output format:         FASTQ, phred_offset=33\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 \cf13 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf13 #\cf4 Code\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f2\b \cf4 #40m
\f3\b0 \
flash 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B8Z_S11_001.unpaired_trimmed_1_40m.fastq 30B8Z_S11_001.unpaired_trimmed_2_40m.fastq -d /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads/merged_reads_flash -o 30B8Z_S11_001_40m_merged\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f2\b \cf4 #70m
\f3\b0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\fs24 \cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 flash 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B90_S12_001.unpaired_trimmed_1_70m.fastq 30B90_S12_001.unpaired_trimmed_2_70m.fastq  -d /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads/merged_reads_flash -o 30B90_S12_001_70m_merged\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f2\b \cf4 #380m
\f3\b0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\fs24 \cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 flash 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B91_S28_001.unpaired_trimmed_1_380m_.fastq 30B91_S28_001.unpaired_trimmed_2_380m.fastq -d /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads/merged_reads_flash -o 30B91_S28_001_380m_merged\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\fs24 \cf13 \cb7 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs26 \cf0 \cb3 \kerning1\expnd0\expndtw0 #Ran the above code as slurm script \
\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0

\f3\b0\fs22 \cf4 \CocoaLigature0 #!/bin/bash\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 #SBATCH --partition=compute                          # Queue selection\
#SBATCH --job-name=flash                             # Job name\
#SBATCH --mail-type=ALL                              # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=elks@mit.edu                    # Where to send mail\
#SBATCH --ntasks=1                                   # Run a single task\
#SBATCH --cpus-per-task=36                           # Number of CPU cores per task\
#SBATCH --mem=20gb                                   # Job memory request\
#SBATCH --time=10:00:00                              # Time limit hrs:min:sec\
#SBATCH --output=flash%j.log                         # Standard output/error\
\
export OMP_NUM_THREADS=16\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\kerning1\expnd0\expndtw0 \CocoaLigature0 \
module load anaconda/5.1\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 source activate sortmerna\
\
cd \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads\
\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f2\b \cf4 #40m
\f3\b0 \
flash \kerning1\expnd0\expndtw0 \CocoaLigature0 30B8Z_S11_001.unpaired_trimmed_1_40m.fastq 30B8Z_S11_001.unpaired_trimmed_2_40m.fastq -d /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads/merged_reads_flash -o 30B8Z_S11_001_40m_merged\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f2\b \cf4 #70m
\f3\b0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 flash \kerning1\expnd0\expndtw0 \CocoaLigature0 30B90_S12_001.unpaired_trimmed_1_70m.fastq 30B90_S12_001.unpaired_trimmed_2_70m.fastq  -d /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads/merged_reads_flash -o 30B90_S12_001_70m_merged\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f2\b \cf4 #380m
\f3\b0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 flash \kerning1\expnd0\expndtw0 \CocoaLigature0 30B91_S28_001.unpaired_trimmed_1_380m_.fastq 30B91_S28_001.unpaired_trimmed_2_380m.fastq -d /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads/merged_reads_flash -o 30B91_S28_001_380m_merged
\f0\b \CocoaLigature1 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf4 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f3\b0 \cf2 \CocoaLigature0 Submitted batch job 1433896\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs36 FAILED - NO OVERLAP IN PAIRED-END READS
\f1\fs26 \cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \cb7 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs28 \cf11 Some notes: had to email the author\'92s again to get the trimmed, paired reads. She had uploaded the unpaired reads, which means that there would be no overlap when combining using BBmerge or Flash. 
\fs26 \
\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\b \cf11 \kerning1\expnd0\expndtw0 Update 10/25/21: one of the authors (Natalie Cohen) accidentally linked the unpaired files. The paired files are much bigger! 
\f1\b0 \cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f3\fs22 \cf2 \cb1 \CocoaLigature0 -rwx------ 1 kaabbott sg-envbio-mgr 4.7G Oct 25 15:59 \cf4 30B90_S12_001.paired_trimmed.fasta\cf2 \
-rw-rw-r-- 1 kaabbott sg-envbio-mgr 3.6G Oct 12 08:30 30B91_S28_001.paired_trimmed.fasta\
-rw-rw-r-- 1 kaabbott sg-envbio-mgr 2.9G Oct 12 08:30 30B8Z_S11_001.paired_trimmed.fasta\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\fs26 \cf4 \cb7 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs28 \cf4 SortMeRNA 4.2.0
\f1\b0\fs26 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \cb3 \
1. Create databases used for rRNA screening. Based on riboPicker\'92s program defaults (what they used), I will use \cf10 SILVA Small subunit reference database (16S/18S) & SILVA Large subunit reference database (23S/28S). No version was given, so I will use SILVA 111 (also used for the 16S and 18S - This WAS specified in the paper.)\
\pard\pardeftab720\sl280\partightenfactor0

\f4\fs24 \cf4 \
Source to cite:\
Pruesse, E., C. Quast, K. Knittel, B. Fuchs, W. Ludwig, J. Peplies, and F.\
O. Glockner. SILVA: a comprehensive online resource for quality checked and\
aligned ribosomal RNA sequence data compatible with ARB. \
Nuc. Acids Res. 2007; Vol. 35, No. 21, p. 7188-7196\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\fs26 \cf10 \
\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f2\b\fs24 \cf0 \cb1 \kerning1\expnd0\expndtw0 #This will give you the newest version. It is 4.2.0. Any 'indexdb_rna' commands will not work. There is only one command now, 'sortmerna'. Everything, including indexing your databases will be done with this. 
\f3\b0 \
\

\f2\b 2. Download the GitHub repo and its contents:\

\f3\b0 \
git clone https://github.com/biocore/sortmerna.git\
\

\f2\b 3. Now there will be a directory called "sortmerna" in conda path
\f3\b0 . \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs22 \cf2 \CocoaLigature0 cd /vortexfs1/home/selkassas/.conda/envs/sortmerna\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 \cf0 \CocoaLigature1 cd sortmerna\
#the sortmerna directory is a subdirectory of the main sortmerna path created by conda\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \

\f2\b 4. Reformat SSU and LSU databases using bash code below
\f3\b0 \
\pard\pardeftab720\sl280\partightenfactor0

\f4 \cf4 \cb3 \expnd0\expndtw0\kerning0
#!/bin/sh\
#\
#   script: (1-2) This script takes as input an rRNA database in the format \
#           of a fasta file and an xml file, both exported from the \
#           ARB package for some complete rRNA database (ex. SILVA).\
#           We use the xml description tags to filter out rRNA\
#           which are not 16S or 23S rRNA. \
#           ARB source http://www.arb-home.de/\
#\
#			(3) The resulting (only 16S or 23S)\
#           fasta file is further filtered by PRINSEQ to remove\
#           long sequences and sequences with more than 1% occurrences\
#           of the ambiguous letter 'N'. Long sequences are defined to be\
#           >1600 nucleotides for 16S rRNA and >5000 nucleotides for \
#           23S rRNA. This aids to remove sequences labeled as `complete \
#           genome', which can include a complete rRNA molecule along\
#           with other coding or non-coding nucleic acids appended to \
#           either end of the molecule (mRNA, tRNA ..). Since only rRNA\
#           sequences are masked out from the NCBI complete bacterial \
#           genomes, the resulting non-rRNA reads can match to an rRNA\
#           database if sequences labeled as `complete genome' are not \
#           filtered out. \
#           PRINSEQ source http://sourceforge.net/projects/prinseq/files/standalone/prinseq-lite-0.17.4.tar.gz\
#\
#			(4) Finally, we apply UCLUST to the filtered database to create\
#           a representative rRNA database with x% id.\
#	        UCLUST source http://www.drive5.com/usearch/\
#\
#   contact: evguenia.kopylova@lifl.fr\
#\
#   date: July 2012\
#\
\
\
# path to ARB-exported rRNA sequences xml file\
SILVAxml=""\
# path to ARB-exported rRNA sequences fasta file\
SILVAfasta=""\
# path to PRINSEQ\
PRINSEQ="prinseq-lite.pl"\
# path to UCLUST\
UCLUST="usearch5.2.32_i86linux32"\
# UCLUST -id value\
ID=98\
\
# Step (1) find non-23s sequences\
\
cat $SILVAxml | grep "5S" -B 45 | sed -n 's/<species name="\\(.*\\)">/\\1/p' > rrna5s.txt\
cat $SILVAxml | grep "5.8S" -B 45 | sed -n 's/<species name="\\(.*\\)">/\\1/p' > rrna5.8s.txt\
cat $SILVAxml | grep "16S" -B 45 | sed -n 's/<species name="\\(.*\\)">/\\1/p' > rrna16s.txt\
cat $SILVAxml | grep "18S" -B 45 | sed -n 's/<species name="\\(.*\\)">/\\1/p' > rrna18s.txt\
cat $SILVAxml | grep "26S" -B 45 | sed -n 's/<species name="\\(.*\\)">/\\1/p' > rrna26s.txt\
cat $SILVAxml | grep "28S" -B 45 | sed -n 's/<species name="\\(.*\\)">/\\1/p' > rrna28s.txt\
\
cat rrna*.txt > totalnon23srrna_temp.txt\
sort totalnon23srrna_temp.txt | uniq -c | awk '\{print $2;\} ' > totalnon23srrna.txt\
rm rrna*.txt\
rm totalnon23srrna_temp.txt\
\
echo "Found all non-23S rRNA."\
echo `wc -l totalnon23srrna.txt`\
\
# Step (2) remove non-23s sequences\
\
# put fasta file into 1 line per entry\
awk '/^>/ \{printf("\\n%s\\t",$0);next;\} \{printf("%s",$0);\} END \{printf("\\n");\}' < $SILVAfasta \\\
	| egrep -v '^$' > $\{SILVAfasta%.fasta\}-1line.fasta\
\
while read not23s\
do\
	sed -i "/$not23s /d" $\{SILVAfasta%.fasta\}-1line.fasta\
done < "totalnon23srrna.txt"\
rm totalnon23srrna.txt\
\
# put back into 2 lines per entry\
tr "\\t" "\\n" < $\{SILVAfasta%.fasta\}-1line.fasta > $\{SILVAfasta%.fasta\}-no23s.fasta\
\
echo "Removed all non-23S rRNA."\
\
# Step (3) PRINSEQ (maximum length 5000, maximum ambigious N's 1%)\
$PRINSEQ -fasta $\{SILVAfasta%.fasta\}-no23s.fasta \\\
   -max_len 5000 -ns_max_p 1 -verbose -out_good $\{SILVAfasta%.fasta\}-no23s-prinseq -out_bad null\
\
# Step (4) UCLUST\
$UCLUST -sort $\{SILVAfasta%.fasta\}-no23s-prinseq.fasta -output $\{SILVAfasta%.fasta\}-no23s-prinseq-sorted.fasta\
$UCLUST -cluster $\{SILVAfasta%.fasta\}-no23s-prinseq-sorted.fasta -seedsout $\{SILVAfasta%.fasta\}-database-id$ID.fasta \\\
	-id 0.$ID\
\
echo "Results:"\
\
echo `grep -c '>' $\{SILVAfasta%.fasta\}-database-id$ID.fasta`\
\
echo "Done."\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f2\b \cf0 \cb1 \kerning1\expnd0\expndtw0 \
#SortmeRNA code - merged, paired reads \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f3\b0 \cf0 \cb3 \
	#\ul general format: \ulnone \
\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0
\cf15 \expnd0\expndtw0\kerning0
sortmerna --ref \cf2 \kerning1\expnd0\expndtw0 \CocoaLigature0 <insert path to reference database 1>\cf15 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref \cf2 \kerning1\expnd0\expndtw0 \CocoaLigature0 <insert path to reference database 2>\cf15 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref \cf2 \kerning1\expnd0\expndtw0 \CocoaLigature0 <insert path to reference database 3> --reads <insert merged reads file from Flash (will end in .extendedFrags.fastq> --aligned <insert file name_rRNA> --fastx --other <insert file name_mRNA> --otu_map -v\
\
#Script\
\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0
\cf4 #!/bin/bash\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 #SBATCH --partition=compute                          # Queue selection\
#SBATCH --job-name=parallel_sortmerna                # Job name\
#SBATCH --mail-type=ALL                              # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=elks@mit.edu                     # Where to send mail\
#SBATCH --ntasks=1                                   # Run a single task\
#SBATCH --cpus-per-task=36                           # Number of CPU cores per task\
#SBATCH --mem=180gb                                  # Job memory request\
#SBATCH --time=24:00:00                              # Time limit hrs:min:sec\
#SBATCH --output=parallel_sortmerna\cf2 %j.log\cf4             # Standard output/error\
\
export OMP_NUM_THREADS=16\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\kerning1\expnd0\expndtw0 \CocoaLigature0 \
module load anaconda/5.1\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 source activate sortmerna\
\
cd 
\fs22 \cf2 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads/fasta_files/paired\
\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0

\fs24 rm -r /vortexfs1/home/selkassas/sortmerna/run\
\
#40m\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 sortmerna --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/rfam-5.8s-database-id98.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/rfam-5s-database-id98.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-arc-16s-id95.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-arc-23s-id98.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-bac-16s-id90.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-bac-23s-id98.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-euk-18s-id95.fasta 
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 --ref\kerning1\expnd0\expndtw0 \CocoaLigature0  
\fs22 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-euk-28s-id98.fasta
\fs24  --reads 
\fs22 \cf2 30B8Z_S11_001.paired_trimmed.fasta
\fs24 \cf4  --aligned 
\fs22 30B8Z_S11_001_40m
\fs24 _rRNA --fastx --other 
\fs22 30B8Z_S11_001_40m
\fs24 _mRNA -v\cf2 \
\
rm -r /vortexfs1/home/selkassas/sortmerna/run\
\
#70m\
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 sortmerna --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/rfam-5.8s-database-id98.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/rfam-5s-database-id98.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-arc-16s-id95.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-arc-23s-id98.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-bac-16s-id90.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-bac-23s-id98.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-euk-18s-id95.fasta 
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 --ref\kerning1\expnd0\expndtw0 \CocoaLigature0  
\fs22 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-euk-28s-id98.fasta
\fs24  --reads 
\fs22 \cf9 30B90_S12_001.paired_trimmed.fasta
\fs24 \cf4  --aligned 
\fs22 \cf9 30B90_S12_001\cf4 _70m
\fs24 _rRNA --fastx --other 
\fs22 \cf9 30B90_S12_001\cf4 _70m
\fs24 _mRNA -v\cf2 \
\
rm -r /vortexfs1/home/selkassas/sortmerna/run\
\
#380m\
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 sortmerna --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/rfam-5.8s-database-id98.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/rfam-5s-database-id98.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-arc-16s-id95.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-arc-23s-id98.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-bac-16s-id90.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-bac-23s-id98.fasta
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1  --ref 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-euk-18s-id95.fasta 
\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 --ref\kerning1\expnd0\expndtw0 \CocoaLigature0  
\fs22 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/rRNA_databases/silva-euk-28s-id98.fasta
\fs24  --reads 
\fs22 \cf2 30B91_S28_001.paired_trimmed.fasta
\fs24 \cf4  --aligned 
\fs22 \cf2 30B91_S28_001\cf4 _380m
\fs24 _rRNA --fastx --other 
\fs22 \cf2 30B91_S28_001\cf4 _380m
\fs24 _mRNA -v\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0
\cf2 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0
\cb7 \
#
\fs22 Submitted batch job 1434576 \'97SUCCESS! \

\fs24 \
\pard\pardeftab720\sl300\partightenfactor0

\f5 \cf4 \cb12 \expnd0\expndtw0\kerning0
\CocoaLigature1 Source: Kopylova E., No\'e9 L. and Touzet H.,\'a0{\field{\*\fldinst{HYPERLINK "http://bioinformatics.oxfordjournals.org/content/28/24/3211"}}{\fldrslt \cf16 "SortMeRNA: Fast and accurate filtering of ribosomal RNAs in metatranscriptomic data"}},\'a0
\f6\i Bioinformatics
\f5\i0 \'a0(2012), doi: 10.1093/bioinformatics/bts611.
\f0\b\fs36 \cf0 \cb1 \kerning1\expnd0\expndtw0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 \
Assembling MetaT reads using SPAdes with RNASPAdes feature \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\fs26 \cf0 \'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97
\fs36 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b0\fs32 \cf4 \cb5 \expnd0\expndtw0\kerning0
Programs used: SPAdes v. 3.15.3
\f0\b\fs36 \cf0 \cb1 \kerning1\expnd0\expndtw0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b0\fs28 \cf0 \
Assembled each separately then concatenated the assemblies. \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f3\fs24 \cf4 #!/bin/bash\
#SBATCH --partition=scavenger            # Queue selection\
#SBATCH --job-name=rnaspade_coassembly   # Job name\
#SBATCH --mail-type=ALL                  # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=selkassas@whoi.edu   # Where to send mail\
#SBATCH --ntasks=1                       # Run a single task\
#SBATCH --cpus-per-task=36               # Number of CPU cores per task\
#SBATCH --mem=180gb                      # Job memory request\
#SBATCH --time=24:00:00                  # Time limit hrs:min:sec\
#SBATCH --output=rnaspades_coassembly.log# Standard output/error\
#export OMP_NUM_THREADS=36\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\b\fs36 \cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f3\b0\fs22 \cf2 \cb3 \CocoaLigature0 /vortexfs1/home/selkassas/.conda/envs/megahit/bin/rnaspades.py
\f1\fs24 \cf0 \CocoaLigature1  -t 36 --12 
\f3\fs22 \CocoaLigature0 30B8Z_S11_001_40m_mRNA.fasta 
\f1\fs24 \CocoaLigature1 -o metaT_assembly_40\

\f3\fs22 \cf2 \CocoaLigature0 /vortexfs1/home/selkassas/.conda/envs/megahit/bin/rnaspades.py
\f1\fs24 \cf0 \CocoaLigature1  -t 36 --12 
\f3\fs22 \CocoaLigature0 30B90_S12_001_70m_mRNA.fasta 
\f1\fs24 \CocoaLigature1 -o metaT_assembly_70
\f0\b\fs36 \cb1 \

\f3\b0\fs22 \cf2 \cb3 \CocoaLigature0 /vortexfs1/home/selkassas/.conda/envs/megahit/bin/rnaspades.py
\f1\fs24 \cf0 \CocoaLigature1  -t 36 --12 
\f3\fs22 \CocoaLigature0 30B91_S28_001_380m_mRNA.fasta 
\f1\fs24 \CocoaLigature1 -o metaT_assembly_380
\fs28 \cb1 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f3\fs24 \cf4 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf4 \cb3 #!/bin/bash\
#SBATCH --partition=scavenger            # Queue selection\
#SBATCH --job-name=rnaspade_coassembly   # Job name\
#SBATCH --mail-type=ALL                  # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=selkassas@whoi.edu   # Where to send mail\
#SBATCH --ntasks=1                       # Run a single task\
#SBATCH --cpus-per-task=36               # Number of CPU cores per task\
#SBATCH --mem=180gb                      # Job memory request\
#SBATCH --time=24:00:00                  # Time limit hrs:min:sec\
#SBATCH --output=rnaspades_coassembly.log# Standard output/error\
#export OMP_NUM_THREADS=36\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\b\fs36 \cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f3\b0\fs24 \cf4 \CocoaLigature0 module load anaconda/5.1\
source activate spades\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f0\b\fs36 \cf0 \CocoaLigature1 #tried with interleaved first now trying with merged. Now trying as single-end. \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f3\b0\fs22 \cf2 \CocoaLigature0 /vortexfs1/home/selkassas/.conda/envs/megahit/bin/rnaspades.py
\f1\fs24 \cf0 \CocoaLigature1  -t 36 
\f3\fs22 \cf2 \CocoaLigature0 \'97s1
\f1\fs24 \cf0 \CocoaLigature1  
\f3\fs22 \CocoaLigature0 30B8Z_S11_001_40m_mRNA.fasta \cf2 \'97s2
\f1\fs24 \cf0 \CocoaLigature1  
\f3\fs22 \CocoaLigature0 30B90_S12_001_70m_mRNA.fasta \cf2 \'97s3 \cf0 30B91_S28_001_380m_mRNA.fasta 
\f1\fs24 \CocoaLigature1 -o metaT_assembly
\f0\b\fs36 \cb1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f3\b0\fs22 \cf2 \CocoaLigature0 \
Submitted batch job 1606354 - FAILED\
Submitted batch job 1606385 - FAILED\
Submitted batch job 1606396 - FAILED\
Submitted batch job 1606406 - FAILED\
Submitted batch job 1606518 - FAILED\
Submitted batch job 1606598 - SUCCESS! \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs36 \cf0 \CocoaLigature1 Annotating metaT assembly using FragGeneScan v.1.31\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\fs26 \cf0 \'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b0\fs32 \cf4 \cb5 \expnd0\expndtw0\kerning0
Programs used: FragGeneScan v.1.31\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \cb7 \

\f0\b\fs28 \cf0 \cb1 \kerning1\expnd0\expndtw0 Description: 
\f1\b0 \cf13 \cb12 \expnd0\expndtw0\kerning0
FragGeneScan is an application for finding (fragmented) genes in short reads. It can also be applied to predict prokaryotic genes in incomplete assemblies or complete genomes.\
\
documentation on how to run: https://github.com/gaberoo/FragGeneScan\
\
They use version 1.16 in the paper, but it was not available via conda, so I just used 1.31. \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs26 \cf0 \cb7 \kerning1\expnd0\expndtw0 Setting up the conda environment: \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 \cb3 \
conda create --name FragGeneScan\
conda activate FragGeneScan\
\pard\pardeftab720\partightenfactor0
\cf13 \expnd0\expndtw0\kerning0
conda install -c bioconda fraggenescan\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs36 \cf0 \cb1 \kerning1\expnd0\expndtw0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b0\fs26 \cf0 Code to run FragGeneScan:\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 \cb3 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f3\fs22 \cf2 \CocoaLigature0 USAGE: ./FragGeneScan -s [seq_file_name] -o [output_file_name] -w [1 or 0] -t [train_file_name] (-p [thread_num])\
\
       Mandatory parameters\
       [seq_file_name]:    sequence file name including the full path\
       [output_file_name]: output file name including the full path\
       [1 or 0]:           1 if the sequence file has complete genomic sequences\
                           0 if the sequence file has short sequence reads\
       [train_file_name]:  file name that contains model parameters; this file should be in the "train" directory\
                           Note that four files containing model parameters already exist in the "train" directory\
                           [complete] for complete genomic sequences or short sequence reads without sequencing error\
                           [sanger_5] for Sanger sequencing reads with about 0.5% error rate\
                           [sanger_10] for Sanger sequencing reads with about 1% error rate\
                           [454_5] for 454 pyrosequencing reads with about 0.5% error rate\
                           [454_10] for 454 pyrosequencing reads with about 1% error rate\
                           [454_30] for 454 pyrosequencing reads with about 3% error rate\
                           [illumina_5] for Illumina sequencing reads with about 0.5% error rate\
                           [illumina_10] for Illumina sequencing reads with about 1% error rate\
\
       Optional parameter\
       [thread_num]:       the number of threads used by FragGeneScan; default is 1 thread.
\f1\fs26 \cf0 \CocoaLigature1 \
\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f3\fs24 \cf4 #!/bin/bash\
#SBATCH --partition=compute            # Queue selection\
#SBATCH --job-name=FragGeneScan_annot    # Job name\
#SBATCH --mail-type=ALL                  # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=selkassas@whoi.edu   # Where to send mail\
#SBATCH --ntasks=1                       # Run a single task\
#SBATCH --cpus-per-task=12               # Number of CPU cores per task\
#SBATCH --mem=80gb                      # Job memory request\
#SBATCH --time=24:00:00                  # Time limit hrs:min:sec\
#SBATCH --output=FragGeneScan_annot.log  # Standard output/error\
#export OMP_NUM_THREADS=12\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f1\fs26 \cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f3\fs24 \cf4 \CocoaLigature0 module load anaconda/5.1\
source activate 
\f1\fs26 \cf0 \CocoaLigature1 FragGeneScan\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf4 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 FragGeneScan -s 
\f3\fs22 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads/fasta_files/paired/mRNA/metaT_assembly/transcripts.fasta -o /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads/fasta_files/paired/mRNA/dino_metzyme_annotated_coassembly -w 0 -t \cb1 illumina_5
\f4\fs28 \cb3 \expnd0\expndtw0\kerning0
\CocoaLigature1  
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 -p 8
\f0\b\fs36 \CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f3\b0\fs22 \cf2 \cb1 \CocoaLigature0 Submitted batch job 1656501 - FAILED\
Submitted batch job 1656694 - FAILED\
Submitted batch job 1656700 - SUCCESS K71
\f0\b\fs36 \cf0 \cb3 \CocoaLigature1 \

\f3\b0\fs22 \cf2 \cb1 \CocoaLigature0 Submitted batch job 1726008 - SUCCESS transcripts.fa\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs36 \cf0 \CocoaLigature1 \
Note: I chose to use the final.contigs file from the k71 folder generated by RNASPAdes. I will need to talk with Harriet to ask if this was the right choice. Additionally, I arbitrarily chose illumina_5 for the train_file_name, though error rates can span from 0.1%-10%. Not sure if this was the right choice either. \
\
Edit: spoke with Harriet, and should use transcripts.fasta in main assembly folder as the input for FragGeneScan. \
\
\pard\pardeftab720\sl260\sa240\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
Mapping reads to ORFs using the Burrows\'96Wheeler Aligner-MEM\cb7  (
\f1\b0 0.7.17) 
\f0\b a\cb1 nd Samtools (
\f1\b0 \cb7 1.14)
\f0\b\fs26 \cf0 \cb1 \kerning1\expnd0\expndtw0 \'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\

\f1\b0\fs32 \cf4 \cb5 \expnd0\expndtw0\kerning0
Programs used: Burrows-Wheeler Aligner 0.7.17 and Samtools 1.14\

\f0\b\fs28 \cf0 \cb1 \kerning1\expnd0\expndtw0 \'97-From what I understand, the mRNA reads need to be mapped to annotated coassembly, so we will have 3 align files and sam and bam files to go with each. FragGeneScan generated the following outputs: \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl360\sa160\partightenfactor0
\ls1\ilvl0
\f1\b0 \cf17 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
The .out file contains a summary of the number of features annotated.\
\ls1\ilvl0\kerning1\expnd0\expndtw0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
The .faa file contains the protein sequences of the genes annotated.\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl360\partightenfactor0
\ls1\ilvl0\cf17 \kerning1\expnd0\expndtw0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
The .ffn file contains the nucleotide sequences of the genes annotated\
\pard\tx720\pardeftab720\sl360\partightenfactor0
\cf17 \
It does not make sense to map untranslated nucleotide sequences to protein sequences, so I used the .ffn file to map the mRNA reads to.
\f7\fs32 \
\pard\pardeftab720\sl260\sa240\partightenfactor0

\f0\b\fs28 \cf0 \kerning1\expnd0\expndtw0 \
\pard\pardeftab720\partightenfactor0

\f1\b0 \cf0 \cb7 I already had this conda environment created for HW3. \
\pard\pardeftab720\partightenfactor0

\fs26 \cf0 \cb3 conda activate 
\f3 \cf2 \CocoaLigature0 bwa_samtools \
\
#Slurm script for submitting bwa mem code on mRNA NUCLEOTIDE files: \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\fs22 \cf4 \CocoaLigature1 #!/bin/bash\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0
\cf4 #SBATCH --partition=scavenger            # Queue selection\
#SBATCH --job-name=bwa_mem_samtools      # Job name\
#SBATCH --mail-type=ALL                  # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=selkassas@whoi.edu   # Where to send mail\
#SBATCH --ntasks=1                       # Run a single task\
#SBATCH --cpus-per-task=36               # Number of CPU cores per task\
#SBATCH --mem=180gb                      # Job memory request\
#SBATCH --time=24:00:00                  # Time limit hrs:min:sec\
#SBATCH --output=bwa_mem_samtools.log    # Standard output/error\
#export OMP_NUM_THREADS=36
\fs26 \cf2 \CocoaLigature0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\fs22 \cf4 \
module load anaconda/5.1\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 source activate bwa_samtools \
\
#did this before running \'97 bwa index \kerning1\expnd0\expndtw0 \CocoaLigature0 dino_metzyme_annotated_coassembly.ffn\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\
#bwa code to map to coassembly  \
\
#40m\
bwa mem -t 8 \cf9 \kerning1\expnd0\expndtw0 \CocoaLigature0 dino_metzyme_annotated_coassembly.ffn\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1  \cf9 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B8Z_S11_001_40m_mRNA.fasta\cf2  \cf4  -o \cf9 30B8Z_S11_001_40m_mRNA\cf4 _mapped.sam\
#70m\
\expnd0\expndtw0\kerning0
\CocoaLigature1 bwa mem -t 8 \cf9 \kerning1\expnd0\expndtw0 \CocoaLigature0 dino_metzyme_annotated_coassembly.ffn\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1  \cf9 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B90_S12_001_70m_mRNA.fasta\cf4  -o \cf9 30B90_S12_001_70m_mRNA\cf4 _mapped.sam\
#380m\
\expnd0\expndtw0\kerning0
\CocoaLigature1 bwa mem -t 8 \cf9 \kerning1\expnd0\expndtw0 \CocoaLigature0 dino_metzyme_annotated_coassembly.ffn\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1  \cf9 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B91_S28_001_380m_mRNA.fasta\cf2  \cf4 -o \cf9 30B91_S28_001_380m_mRNA\cf4 _mapped.sam\
\
#use samtools to convert sam to bam\
\expnd0\expndtw0\kerning0
\CocoaLigature1 #40m\kerning1\expnd0\expndtw0 \CocoaLigature0 \
samtools view -S -b \cf9 30B8Z_S11_001_40m_mRNA\cf4 _mapped.sam > \cf9 30B8Z_S11_001_40m_mRNA\cf4 _mapped.bam\
#70m\
samtools view -S -b \cf9 30B90_S12_001_70m_mRNA\cf4 _mapped.sam > \cf9 30B90_S12_001_70m_mRNA\cf4 _mapped.bam\
#380m\
samtools view -S -b \cf9 30B91_S28_001_380m_mRNA\cf4 _mapped.sam > \cf9 30B91_S28_001_380m_mRNA\cf4 _mapped.bam\
\
#use samtools to sort bam files in order to input into diamond\
\expnd0\expndtw0\kerning0
\CocoaLigature1 #40m\kerning1\expnd0\expndtw0 \CocoaLigature0 \
s\expnd0\expndtw0\kerning0
\CocoaLigature1 amtools sort \cf9 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B8Z_S11_001_40m_mRNA\cf4 _mapped.bam\expnd0\expndtw0\kerning0
\CocoaLigature1  -o \cf9 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B8Z_S11_001_40m_mRNA\cf4 _mapped\expnd0\expndtw0\kerning0
\CocoaLigature1 _sorted.bam\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 #70m\
samtools sort \cf9 30B90_S12_001_70m_mRNA\cf4 _mapped.bam -o \cf9 30B90_S12_001_70m_mRNA\cf4 _mapped_sorted.bam\
#380m\
samtools sort \cf9 30B91_S28_001_380m_mRNA\cf4 _mapped.bam -o \cf9 30B91_S28_001_380m_mRNA\cf4 _mapped_sorted.bam\
\
\pard\pardeftab720\partightenfactor0

\fs26 \cf2 #Slurm script for submitting bwa mem code on mRNA AMINO ACID files: \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\fs22 \cf4 \CocoaLigature1 #!/bin/bash\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0
\cf4 #SBATCH --partition=scavenger            # Queue selection\
#SBATCH --job-name=bwa_mem_samtools      # Job name\
#SBATCH --mail-type=ALL                  # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=selkassas@whoi.edu   # Where to send mail\
#SBATCH --ntasks=1                       # Run a single task\
#SBATCH --cpus-per-task=36               # Number of CPU cores per task\
#SBATCH --mem=180gb                      # Job memory request\
#SBATCH --time=24:00:00                  # Time limit hrs:min:sec\
#SBATCH --output=bwa_mem_samtools.log    # Standard output/error\
#export OMP_NUM_THREADS=36
\fs26 \cf2 \CocoaLigature0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\fs22 \cf4 \
module load anaconda/5.1\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 source activate bwa_samtools \
\
#did this before running \'97 bwa index \kerning1\expnd0\expndtw0 \CocoaLigature0 dino_metzyme_annotated_coassembly.faa\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\
#bwa code to map to coassembly  \
\
#40m\
bwa mem -t 8 \cf9 \cb1 \kerning1\expnd0\expndtw0 \CocoaLigature0 dino_metzyme_annotated_coassembly.faa\cf4 \cb3 \expnd0\expndtw0\kerning0
\CocoaLigature1  \cf9 \cb1 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B8Z_S11_001_40m_mRNA_annotated.faa\cf4 \cb3  -o \cf9 30B8Z_S11_001_40m_mRNA\cf4 _translated_mapped.sam\
#70m\
\expnd0\expndtw0\kerning0
\CocoaLigature1 bwa mem -t 8 \cf9 \cb1 \kerning1\expnd0\expndtw0 \CocoaLigature0 dino_metzyme_annotated_coassembly.faa\cf4 \cb3 \expnd0\expndtw0\kerning0
\CocoaLigature1  \cf9 \cb1 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B90_S12_001_70m_mRNA_annotated.faa\cf4 \cb3  -o \cf9 30B90_S12_001_70m_mRNA\cf4 _translated_mapped.sam\
#380m\
\expnd0\expndtw0\kerning0
\CocoaLigature1 bwa mem -t 8 \cf9 \cb1 \kerning1\expnd0\expndtw0 \CocoaLigature0 dino_metzyme_annotated_coassembly.faa\cf4 \cb3 \expnd0\expndtw0\kerning0
\CocoaLigature1  \cf9 \cb1 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B91_S28_001_380m_mRNA_annotated.faa\cf2 \cb3  \cf4 -o \cf9 30B91_S28_001_380m_mRNA\cf4 _translated_mapped.sam\
\
#use samtools to convert sam to bam\
\expnd0\expndtw0\kerning0
\CocoaLigature1 #40m\kerning1\expnd0\expndtw0 \CocoaLigature0 \
samtools view -S -b \cf9 30B8Z_S11_001_40m_mRNA\cf4 _translated_mapped.sam > \cf9 30B8Z_S11_001_40m_mRNA\cf4 _translated_mapped.bam\
#70m\
samtools view -S -b \cf9 30B90_S12_001_70m_mRNA\cf4 _translated_mapped.sam > \cf9 30B90_S12_001_70m_mRNA\cf4 _translated_mapped.bam\
#380m\
samtools view -S -b \cf9 30B91_S28_001_380m_mRNA\cf4 _translated_mapped.sam > \cf9 30B91_S28_001_380m_mRNA\cf4 _translated_mapped.bam\
\
#use samtools to sort bam files in order to input into diamond\
\expnd0\expndtw0\kerning0
\CocoaLigature1 #40m\kerning1\expnd0\expndtw0 \CocoaLigature0 \
s\expnd0\expndtw0\kerning0
\CocoaLigature1 amtools sort \cf9 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B8Z_S11_001_40m_mRNA\cf4 _translated_mapped.bam\expnd0\expndtw0\kerning0
\CocoaLigature1  -o \cf9 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B8Z_S11_001_40m_mRNA\cf4 _translated_mapped\expnd0\expndtw0\kerning0
\CocoaLigature1 _sorted.bam\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 #70m\
samtools sort \cf9 30B90_S12_001_70m_mRNA\cf4 _translated_mapped.bam -o \cf9 30B90_S12_001_70m_mRNA\cf4 _translated_mapped_sorted.bam\
#380m\
samtools sort \cf9 30B91_S28_001_380m_mRNA\cf4 _translated_mapped.bam -o \cf9 30B91_S28_001_380m_mRNA\cf4 _translated_mapped_sorted.bam
\fs26 \cf2 \
\pard\pardeftab720\partightenfactor0
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs22 \cb1 Submitted batch job 1726091 - SUCCESS!!\'92\
Submitted batch job 1747008 - Failed\
Submitted batch job 1747013 - failed, forgot to index .ffn file\
Submitted batch job 1747033 -failed\
Submitted batch job 1747049 - SUCCESS! \
\
\
\
\pard\pardeftab720\partightenfactor0

\f0\b\fs36 \cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 Assigning taxonomy and function to ORFs using Diamond (2.0.13) with BlastP and PhytoREF DB
\fs26 \cf0 \kerning1\expnd0\expndtw0 \'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\

\f1\b0\fs32 \cf4 \cb5 \expnd0\expndtw0\kerning0
Programs used: diamond 2.0.13, BlastP db, FragGeneScan v.1.31\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs36 \cf0 \cb1 \kerning1\expnd0\expndtw0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b0\fs26 \cf0 Creating the conda environment: \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 \cb3 \
conda create \'97-name diamond\
conda activate diamond\
\pard\pardeftab720\partightenfactor0
\cf13 \cb14 \expnd0\expndtw0\kerning0
conda install -c bioconda diamond\

\f0\b\fs36 \cf0 \cb3 \kerning1\expnd0\expndtw0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 \cb1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b0\fs28 \cf0 Great resource for how to run this code: https://github.com/bbuchfink/diamond/wiki/3.-Command-line-options\
- issues: it seems like it needs translated mRNA as the input. May have to annotate the mRNA too and not just the assemblies\
update: annotated mRNA using FragGeneScan using commands below: \cb6 OR DO WE NEED THE BAM FILES CREATED DURING MAPPING??? SO CONFUSING! \
update update: Katy and I settled on using the BAM files created during mapping the annotated .faa mRNA files to the annotated .faa coassembly. That way everything was mapped translated-translated and will be compatible with BlastP\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs24 \cf0 \cb3 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f3\b0 \cf4 #!/bin/bash\
#SBATCH --partition=compute            # Queue selection\
#SBATCH --job-name=FragGeneScan_annot    # Job name\
#SBATCH --mail-type=ALL                  # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=selkassas@whoi.edu   # Where to send mail\
#SBATCH --ntasks=1                       # Run a single task\
#SBATCH --cpus-per-task=12               # Number of CPU cores per task\
#SBATCH --mem=80gb                      # Job memory request\
#SBATCH --time=24:00:00                  # Time limit hrs:min:sec\
#SBATCH --output=FragGeneScan_annot.log  # Standard output/error\
#export OMP_NUM_THREADS=12\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f1\fs26 \cf4 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f3\fs24 \cf4 \CocoaLigature0 module load anaconda/5.1\
source activate 
\f1\fs26 \CocoaLigature1 FragGeneScan\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf4 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 FragGeneScan -s 
\f3\fs22 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads/fasta_files/paired/mRNA/30B8Z_S11_001_40m_mRNA.fasta -o /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads/fasta_files/paired/mRNA/30B8Z_S11_001_40m_mRNA_annotated -w 0 -t illumina_5
\f4\fs28 \expnd0\expndtw0\kerning0
\CocoaLigature1  
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 -p 8
\f0\b\fs36 \CocoaLigature1 \
\

\f1\b0\fs26 FragGeneScan -s 
\f3\fs22 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads/fasta_files/paired/mRNA/30B90_S12_001_70m_mRNA.fasta -o /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads/fasta_files/paired/mRNA/30B90_S12_001_70m_mRNA_annotated -w 0 -t illumina_5
\f4\fs28 \expnd0\expndtw0\kerning0
\CocoaLigature1  
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 -p 8
\f0\b\fs36 \CocoaLigature1 \
\

\f1\b0\fs26 FragGeneScan -s 
\f3\fs22 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads/fasta_files/paired/mRNA/30B91_S28_001_380m_mRNA.fasta -o /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/metaT_trimmed_reads/fasta_files/paired/mRNA/30B91_S28_001_380m_mRNA_annotated -w 0 -t illumina_5
\f4\fs28 \expnd0\expndtw0\kerning0
\CocoaLigature1  
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 -p 8
\f0\b\fs36 \CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f3\b0\fs22 \cf4 \CocoaLigature0 \
Submitted batch job 1746094 - Failed, forgot to put train file in the same directory as the .sh file. \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf2 Submitted batch job 1746102 - Success\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs36 \cf0 \CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 \cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b0\fs26 \cf8 \cb12 \expnd0\expndtw0\kerning0
The next step is to setup a binary DIAMOND database file that can be used for subsequent searches against the database:\
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3 \
diamond makedb --in \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/PhyloDB/phylodb_1.076.pep.fa.gz\expnd0\expndtw0\kerning0
\CocoaLigature1  -d PhyloDB\
\'97> \'97in must be a fasta file \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b \cf0 \cb1 \kerning1\expnd0\expndtw0 \
\pard\pardeftab720\sl360\partightenfactor0

\f1\b0 \cf8 \cb12 \expnd0\expndtw0\kerning0
A binary file (\cb1 PhyloDB.dmnd\cb12 ) containing the database sequences will be created in the current working directory. We will now conduct a search against this database using the translated mRNA mapped and sorted binary files as queries:\cb1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b \cf0 \kerning1\expnd0\expndtw0 \
CODE FOR .FAA FILES GENERATED BY FRAGGENESCAN CODE ABOVE - THEN RUN THROUGH BWA-MEM AND SORTED WITH SAMTOOLS\
update: ended up having to use the fasta files anyways. \
\pard\pardeftab720\sl380\partightenfactor0

\f1\b0 \cf8 \cb3 \expnd0\expndtw0\kerning0
\
diamond blastp -q 
\f3\fs22 \cf9 \cb1 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B8Z_S11_001_40m_mRNA.fasta\cf2  
\f1\fs26 \cf8 \cb3 \expnd0\expndtw0\kerning0
\CocoaLigature1 -d PhyloDB --evalue 0.001 -o \cf9 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B8Z_S11_001_40m_mRNA_diamond_\cf8 \expnd0\expndtw0\kerning0
\CocoaLigature1 out.tsv \
diamond blastp -q 
\f3\fs22 \cf9 \cb1 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B90_S12_001_70m_mRNA.fasta\cf2  
\f1\fs26 \cf8 \cb3 \expnd0\expndtw0\kerning0
\CocoaLigature1 -d PhyloDB --evalue 0.001 -o \cf9 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B90_S12_001_70m_mRNA_diamond_\cf8 \expnd0\expndtw0\kerning0
\CocoaLigature1 out.tsv \
diamond blastp -q 
\f3\fs22 \cf9 \cb1 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B91_S28_001_380m_mRNA.fasta\cf2  
\f1\fs26 \cf8 \cb3 \expnd0\expndtw0\kerning0
\CocoaLigature1 -d PhyloDB --evalue 0.001 -o \cf9 \kerning1\expnd0\expndtw0 \CocoaLigature0 30B91_S28_001_380m_mRNA_diamond_\cf8 \expnd0\expndtw0\kerning0
\CocoaLigature1 out.tsv 
\f3\fs27\fsmilli13600 \
\pard\pardeftab720\sl380\partightenfactor0

\f0\b\fs36 \cf0 \kerning1\expnd0\expndtw0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f3\b0\fs22 \cf2 \cb1 \CocoaLigature0 Submitted batch job 1748451\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs36 \cf0 \CocoaLigature1 \
Classifying 16S using FASTA36 (FAILED) but actually used KRAKEN2
\fs26 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b0\fs32 \cf4 \cb5 \expnd0\expndtw0\kerning0
Programs used: FLASH 1.2.11, fq2fa 1.1.3, FASTA36 36.3.8e, kraken2 2.1.2 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs26 \cf4 \cb7 \
Setting up the conda environment:\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \cb3 \
conda create \'97-name fasta36\
conda activate fasta36\
\pard\pardeftab720\partightenfactor0
\cf13 \cb14 conda install -c biobuilds fasta\
#there is a more updated version on GitHub, but it is not working for current users. \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 \cf4 \cb1 \
Got the Silva111 database release from https://ftp.arb-silva.de/\
They are both zipped .tgz files\
\cb3 \
#SSU\
wget https://ftp.arb-silva.de/release_111/Exports/SSURef_111_tax_silva.fasta.tgz\
\
#LSU\
wget https://ftp.arb-silva.de/release_111/Exports/LSURef_111_tax_silva.fasta.tgz\
\
#unzipping tar files\
tar -xvzf 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 SSURef_111_tax_silva.fasta.tgz\
tar -xvzf LSURef_111_tax_silva.fasta.tgz
\f1\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\cb1 \
Merge paired-end reads using Flash\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f2\b \cf4 \cb3 conda activate sortmerna #has flash installed\
\
#40m\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f3\b0 \cf4 flash 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI040_16S_TCGACGAG_R1_val_1.fq.gz WHOI040_16S_TCGACGAG_R2_val_2.fq.gz -d /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/merged_16S -o WHOI040_16S_TCGACGAG_40m_merged
\f2\b\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\
#70m\

\f3\b0 flash 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI020_16S_TCGACGAG_R1_val_1.fq.gz WHOI020_16S_TCGACGAG_R2_val_2.fq.gz -d /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/merged_16S -o WHOI020_16S_TCGACGAG_70m_merged
\f2\b\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\
#380m
\f3\b0 \
flash 
\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI010_16S_AGAGTCAC_R1_val_1.fq.gz WHOI010_16S_AGAGTCAC_R2_val_2.fq.gz -d \cf2 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/merged_16S\cf4  -o WHOI010_16S_AGAGTCAC_380m_merged\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 \cb1 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs26 \cf4 Change .fastq files to .fasta files using fq2fa (IDBA_UD extension) so they are compatible with fasta36:\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 \cf4 \cb3 #get fq2fa in fasta36 environment\
git clone git@github.com:loneknightpy/idba.git\
\
#files must be unzipped first\
for file in *.fq.gz\
do \
gunzip $\{file\}\
done\
\
#Proceed to fq2fa\
\pard\pardeftab720\sl380\partightenfactor0
\cf8 #usage: fq2fa --merge --filter read_1.fq read_2.fq read.fa\
fq2fa --merge --filter \cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI040_16S_TCGACGAG_R1_val_1.fq WHOI040_16S_TCGACGAG_R2_val_2.fq WHOI040_16S_TCGACGAG_40m_merged.fasta\cf8 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 fq2fa \cf8 --merge --filter 
\f3\fs22 \cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI020_16S_TCGACGAG_R1_val_1.fq WHOI020_16S_TCGACGAG_R2_val_2.fq WHOI020_16S_TCGACGAG_70m_merged.fasta\

\f1\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 fq2fa \cf8 --merge --filter 
\f3\fs22 \cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI010_16S_AGAGTCAC_R1_val_1.fq WHOI010_16S_AGAGTCAC_R2_val_2.fq WHOI010_16S_AGAGTCAC_380m_merged.fasta
\f1\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\cb1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \cb11 Code to run fasta36:\
\
manual: https://home.cc.umanitoba.ca/~psgendb/doc/fasta/fasta36.1.html\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs28 \cf4 Had to split files in 4 first, as they wouldn\'92t run otherwise. Here is an example of how I did that:\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f3\fs22 \cf2 \kerning1\expnd0\expndtw0 \CocoaLigature0 \
wc -l WHOI040_16S_TCGACGAG_40m_merged.fasta\
output: 58568 WHOI040_16S_TCGACGAG_40m_merged.fasta\
head -n 29284 WHOI040_16S_TCGACGAG_40m_merged.fasta > head_WHOI040_16S_TCGACGAG_40m_merged.fasta\
tail -n 29248 WHOI040_16S_TCGACGAG_40m_merged.fasta > tail_WHOI040_16S_TCGACGAG_40m_merged.fasta\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\fs28 \cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 \cf4 \
Fasta36 code: NOTHING WORKED. USED KRAKEN2 INSTEAD\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0

\f3\fs22 \cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 #!/bin/bash\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 #SBATCH --partition=compute                          # Queue selection\
#SBATCH --job-name=fasta36                           # Job name\
#SBATCH --mail-type=ALL                              # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=elks@mit.edu                     # Where to send mail\
#SBATCH --ntasks=1                                   # Run a single task\
#SBATCH --cpus-per-task=36                           # Number of CPU cores per task\
#SBATCH --mem=180gb                                   # Job memory request\
#SBATCH --time=24:00:00                              # Time limit hrs:min:sec\
#SBATCH --output=fasta36_16S%j.log                   # Standard output/error\
\
export OMP_NUM_THREADS=16\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\kerning1\expnd0\expndtw0 \CocoaLigature0 \
module load anaconda/5.1\
\expnd0\expndtw0\kerning0
\CocoaLigature1 source activate fasta36\
\
cd \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/merged_fasta\
\expnd0\expndtw0\kerning0
\CocoaLigature1 \
#380m head, SSU\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 head_WHOI010_16S_AGAGTCAC_380m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/SSURef_111_tax_silva.fasta > head_WHOI010_16S_AGAGTCAC_380m_SSU_taxonomy\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf2 Submitted batch job 1434719\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0
\cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 #!/bin/bash\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 #SBATCH --partition=compute                          # Queue selection\
#SBATCH --job-name=fasta36                           # Job name\
#SBATCH --mail-type=ALL                              # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=elks@mit.edu                     # Where to send mail\
#SBATCH --ntasks=1                                   # Run a single task\
#SBATCH --cpus-per-task=36                           # Number of CPU cores per task\
#SBATCH --mem=180gb                                   # Job memory request\
#SBATCH --time=24:00:00                              # Time limit hrs:min:sec\
#SBATCH --output=fasta36_16S%j.log                   # Standard output/error\
\
export OMP_NUM_THREADS=16\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\kerning1\expnd0\expndtw0 \CocoaLigature0 \
module load anaconda/5.1\
\expnd0\expndtw0\kerning0
\CocoaLigature1 source activate fasta36\
\
cd \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/merged_fasta\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 #380 tail, SSU \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 tail_WHOI010_16S_AGAGTCAC_380m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/SSURef_111_tax_silva.fasta > tail_WHOI010_16S_AGAGTCAC_380m_SSU_taxonomy\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf2 Submitted batch job 1434720\cf4 \
\
\
Submitted batch job 1434698 - FAILED\
\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0
\cf4 #!/bin/bash\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 #SBATCH --partition=compute                          # Queue selection\
#SBATCH --job-name=fasta36                           # Job name\
#SBATCH --mail-type=ALL                              # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=elks@mit.edu                     # Where to send mail\
#SBATCH --ntasks=1                                   # Run a single task\
#SBATCH --cpus-per-task=36                           # Number of CPU cores per task\
#SBATCH --mem=180gb                                   # Job memory request\
#SBATCH --time=24:00:00                              # Time limit hrs:min:sec\
#SBATCH --output=fasta36_16S%j.log                   # Standard output/error\
\
export OMP_NUM_THREADS=16\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\kerning1\expnd0\expndtw0 \CocoaLigature0 \
module load anaconda/5.1\
\expnd0\expndtw0\kerning0
\CocoaLigature1 source activate fasta36\
\
cd \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/merged_fasta\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 #380m head, LSU\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 head_WHOI010_16S_AGAGTCAC_380m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/LSURef_111_tax_silva.fasta > head_WHOI010_16S_AGAGTCAC_380m_LSU_taxonomy\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
#380 tail, LSU \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 tail_WHOI010_16S_AGAGTCAC_380m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/LSURef_111_tax_silva.fasta > tail_WHOI010_16S_AGAGTCAC_380m_LSU_taxonomy\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 Submitted batch job 1434701\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0
\cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 #!/bin/bash\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 #SBATCH --partition=compute                          # Queue selection\
#SBATCH --job-name=fasta36_2                           # Job name\
#SBATCH --mail-type=ALL                              # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=elks@mit.edu                     # Where to send mail\
#SBATCH --ntasks=1                                   # Run a single task\
#SBATCH --cpus-per-task=36                           # Number of CPU cores per task\
#SBATCH --mem=180gb                                   # Job memory request\
#SBATCH --time=24:00:00                              # Time limit hrs:min:sec\
#SBATCH --output=fasta36_2_16S%j.log                   # Standard output/error\
\
export OMP_NUM_THREADS=16\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\kerning1\expnd0\expndtw0 \CocoaLigature0 \
module load anaconda/5.1\
\expnd0\expndtw0\kerning0
\CocoaLigature1 source activate fasta36\
\
cd \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/merged_fasta\
\expnd0\expndtw0\kerning0
\CocoaLigature1 \
#70m head, SSU\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 head_WHOI020_16S_TCGACGAG_70m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/SSURef_111_tax_silva.fasta > head_WHOI020_16S_TCGACGAG_70m_SSU_taxonomy\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf2 \kerning1\expnd0\expndtw0 \CocoaLigature0 Submitted batch job 1434721\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0
\cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 #!/bin/bash\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 #SBATCH --partition=compute                          # Queue selection\
#SBATCH --job-name=fasta36_2                           # Job name\
#SBATCH --mail-type=ALL                              # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=elks@mit.edu                     # Where to send mail\
#SBATCH --ntasks=1                                   # Run a single task\
#SBATCH --cpus-per-task=36                           # Number of CPU cores per task\
#SBATCH --mem=180gb                                   # Job memory request\
#SBATCH --time=24:00:00                              # Time limit hrs:min:sec\
#SBATCH --output=fasta36_2_16S%j.log                   # Standard output/error\
\
export OMP_NUM_THREADS=16\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\kerning1\expnd0\expndtw0 \CocoaLigature0 \
module load anaconda/5.1\
\expnd0\expndtw0\kerning0
\CocoaLigature1 source activate fasta36\
\
cd \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/merged_fasta\
\expnd0\expndtw0\kerning0
\CocoaLigature1 \
#70 tail, SSU \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 tail_WHOI020_16S_TCGACGAG_70m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/SSURef_111_tax_silva.fasta > tail_WHOI020_16S_TCGACGAG_70m_SSU_taxonomy\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf2 \kerning1\expnd0\expndtw0 \CocoaLigature0 Submitted batch job 1434723\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \
Submitted batch job 1434703\expnd0\expndtw0\kerning0
\CocoaLigature1 \'97- FAILED\
\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0
\cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 #!/bin/bash\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 #SBATCH --partition=compute                          # Queue selection\
#SBATCH --job-name=fasta36_3                           # Job name\
#SBATCH --mail-type=ALL                              # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=elks@mit.edu                     # Where to send mail\
#SBATCH --ntasks=1                                   # Run a single task\
#SBATCH --cpus-per-task=36                           # Number of CPU cores per task\
#SBATCH --mem=180gb                                   # Job memory request\
#SBATCH --time=24:00:00                              # Time limit hrs:min:sec\
#SBATCH --output=fasta36_3_16S%j.log                   # Standard output/error\
\
export OMP_NUM_THREADS=16\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\kerning1\expnd0\expndtw0 \CocoaLigature0 \
module load anaconda/5.1\
\expnd0\expndtw0\kerning0
\CocoaLigature1 source activate fasta36\
\
cd \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/merged_fasta\
\expnd0\expndtw0\kerning0
\CocoaLigature1 \
#70m head, LSU\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 head_WHOI020_16S_TCGACGAG_70m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/LSURef_111_tax_silva.fasta > head_WHOI020_16S_TCGACGAG_70m_LSU_taxonomy\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
#70 tail, LSU \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 tail_WHOI020_16S_TCGACGAG_70m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/LSURef_111_tax_silva.fasta > tail_WHOI020_16S_TCGACGAG_70m_LSU_taxonomy\
\
\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 Submitted batch job 1434704\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \
\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0
\cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 #!/bin/bash\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 #SBATCH --partition=compute                          # Queue selection\
#SBATCH --job-name=fasta36_4                         # Job name\
#SBATCH --mail-type=ALL                              # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=elks@mit.edu                     # Where to send mail\
#SBATCH --ntasks=1                                   # Run a single task\
#SBATCH --cpus-per-task=36                           # Number of CPU cores per task\
#SBATCH --mem=180gb                                  # Job memory request\
#SBATCH --time=24:00:00                              # Time limit hrs:min:sec\
#SBATCH --output=fasta36_4_16S%j.log                 # Standard output/error\
\
export OMP_NUM_THREADS=16\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\kerning1\expnd0\expndtw0 \CocoaLigature0 \
module load anaconda/5.1\
\expnd0\expndtw0\kerning0
\CocoaLigature1 source activate fasta36\
\
cd \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/merged_fasta\
\expnd0\expndtw0\kerning0
\CocoaLigature1 \
#40m head, SSU\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 head_WHOI040_16S_TCGACGAG_40m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/SSURef_111_tax_silva.fasta > head_WHOI040_16S_TCGACGAG_40m_SSU_taxonomy\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf2 Submitted batch job 1434726\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0
\cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 #!/bin/bash\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 #SBATCH --partition=compute                          # Queue selection\
#SBATCH --job-name=fasta36_4                           # Job name\
#SBATCH --mail-type=ALL                              # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=elks@mit.edu                     # Where to send mail\
#SBATCH --ntasks=1                                   # Run a single task\
#SBATCH --cpus-per-task=36                           # Number of CPU cores per task\
#SBATCH --mem=180gb                                   # Job memory request\
#SBATCH --time=24:00:00                              # Time limit hrs:min:sec\
#SBATCH --output=fasta36_4_16S%j.log                   # Standard output/error\
\
export OMP_NUM_THREADS=16\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\kerning1\expnd0\expndtw0 \CocoaLigature0 \
module load anaconda/5.1\
\expnd0\expndtw0\kerning0
\CocoaLigature1 source activate fasta36\
\
cd \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/merged_fasta\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 #40 tail, SSU \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 tail_WHOI040_16S_TCGACGAG_40m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/SSURef_111_tax_silva.fasta > tail_WHOI040_16S_TCGACGAG_40m_SSU_taxonomy\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf2 \kerning1\expnd0\expndtw0 \CocoaLigature0 Submitted batch job 1434727\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0
\cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 #!/bin/bash\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 #SBATCH --partition=compute                          # Queue selection\
#SBATCH --job-name=fasta36_5                           # Job name\
#SBATCH --mail-type=ALL                              # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=elks@mit.edu                     # Where to send mail\
#SBATCH --ntasks=1                                   # Run a single task\
#SBATCH --cpus-per-task=36                           # Number of CPU cores per task\
#SBATCH --mem=180gb                                   # Job memory request\
#SBATCH --time=24:00:00                              # Time limit hrs:min:sec\
#SBATCH --output=fasta36_5_16S%j.log                   # Standard output/error\
\
export OMP_NUM_THREADS=16\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\kerning1\expnd0\expndtw0 \CocoaLigature0 \
module load anaconda/5.1\
\expnd0\expndtw0\kerning0
\CocoaLigature1 source activate fasta36\
\
cd \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/merged_fasta\
\expnd0\expndtw0\kerning0
\CocoaLigature1 \
#40m head, LSU\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 head_WHOI040_16S_TCGACGAG_40m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/LSURef_111_tax_silva.fasta > head_WHOI040_16S_TCGACGAG_40m_LSU_taxonomy\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
#40 tail, LSU \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 tail_WHOI040_16S_TCGACGAG_40m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/LSURef_111_tax_silva.fasta > tail_WHOI040_16S_TCGACGAG_40m_LSU_taxonomy\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\
\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\
\
Tried the code below, but it wouldn\'92t work on the full files. \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 #40m, SSU\
fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI040_16S_TCGACGAG_40m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/SSURef_111_tax_silva.fasta > WHOI040_16S_TCGACGAG_40m_SSU_taxonomy\

\f1\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
#40m, LSU\
fasta36 -n 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI040_16S_TCGACGAG_40m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/LSURef_111_tax_silva.fasta > WHOI040_16S_TCGACGAG_40m_LSU_taxonomy\
\

\f1\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 #70m, SSU\
fasta36 -n 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI020_16S_TCGACGAG_70m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/SSURef_111_tax_silva.fasta > WHOI020_16S_TCGACGAG_70m_SSU_taxonomy\

\f1\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
#70m, LSU\
fasta36 -n 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI020_16S_TCGACGAG_70m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/LSURef_111_tax_silva.fasta > WHOI020_16S_TCGACGAG_70m_LSU_taxonomy\
\

\f1\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 #380m, SSU\
fasta36 -n 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI010_16S_AGAGTCAC_380m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/SSURef_111_tax_silva.fasta > WHOI010_16S_AGAGTCAC_380m_SSU_taxonomy\

\f1\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
#380m, LSU\
fasta36 -n 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI010_16S_AGAGTCAC_380m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/LSURef_111_tax_silva.fasta > WHOI010_16S_AGAGTCAC_380m_LSU_taxonomy\
\
mv *taxonomy* /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/taxonomy\
\
\'97\
pasted script above in a nano doc called \'93fasta36_16S.sh\'94\
Submitted batch job 1434090 - FAILED\
Submitted batch job 1434577 - FAILED \cf2 \
Submitted batch job 1434578 - FAILED\
Submitted batch job 1434678 - FAILED\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cb7 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs36 Note: LSU was run using Fasta36, but SSU was run using Kraken2.\
\
KRAKEN2 Code\
Had to get the kraken formatted silva132 db from the kraken website first\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\fs24 \cf4 \cb3 \CocoaLigature1 #!/bin/bash\
#SBATCH --partition=scavenger            # Queue selection\
#SBATCH --job-name=kraken2               # Job name\
#SBATCH --mail-type=ALL                  # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=selkassas@whoi.edu   # Where to send mail\
#SBATCH --ntasks=1                       # Run a single task\
#SBATCH --cpus-per-task=36               # Number of CPU cores per task\
#SBATCH --mem=180gb                      # Job memory request\
#SBATCH --time=24:00:00                  # Time limit hrs:min:sec\
#SBATCH --output=kraken2.log             # Standard output/error\
#export OMP_NUM_THREADS=36\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\b \cf4 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f3\b0 \cf4 \CocoaLigature0 module load anaconda/5.1\
source activate kraken2\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1 \cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 #40m, SSU\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \kerning1\expnd0\expndtw0 kraken2 --db
\f3 \CocoaLigature0  /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/16S_SILVA132_k2db
\f0\b \CocoaLigature1  
\f3\b0 \CocoaLigature0 --output WHOI040_16S_TCGACGAG_40m_taxonomy --\cf8 \expnd0\expndtw0\kerning0
\CocoaLigature1 report 40m.kreport \cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI040_16S_TCGACGAG_40m_merged.fasta\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1 \cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
#70m, SSU\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \kerning1\expnd0\expndtw0 kraken2 --db
\f3 \CocoaLigature0  /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/16S_SILVA132_k2db
\f0\b \CocoaLigature1  
\f3\b0 \CocoaLigature0 --output WHOI020_16S_TCGACGAG_70m_taxonomy \cf8 \expnd0\expndtw0\kerning0
\CocoaLigature1 --report 70m.kreport\cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0  WHOI020_16S_TCGACGAG_70m_merged.fasta\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1 \cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
#380m, SSU\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \kerning1\expnd0\expndtw0 kraken2 --db
\f3 \CocoaLigature0  /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/16S_SILVA132_k2db
\f0\b \CocoaLigature1  
\f3\b0 \CocoaLigature0 --output WHOI010_16S_AGAGTCAC_380m_taxonomy \cf8 \expnd0\expndtw0\kerning0
\CocoaLigature1 --report 380m.kreport \cf4 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI010_16S_AGAGTCAC_380m_merged.fasta\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs22 \cf2 Submitted batch job 1606642 - FAILED exit code 20 \'97 too many people on poseidon\
Submitted batch job 1606645 - FAILED wrong db\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cb6 Submitted batch job 1606709 - FAILED no reason?\
Submitted batch job 1606728 - FAILED\
Submitted batch job 1606733 -FAILED\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cb1 \
(kraken2) [selkassas@poseidon-l2 original_merged_fasta_files]$ kraken2 --db /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/16S_SILVA132_k2db --output WHOI040_16S_TCGACGAG_40m_taxonomy --report 40m.kreport WHOI040_16S_TCGACGAG_40m_merged.fasta\
Loading database information... done.\
29284 sequences (8.26 Mbp) processed in 0.880s (1995.7 Kseq/m, 562.78 Mbp/m).\
 \cf4 \cb6  29200 sequences classified (99.71%)\
  84 sequences unclassified (0.29%)\cf2 \cb1 \
(kraken2) [selkassas@poseidon-l2 original_merged_fasta_files]$ kraken2 --db /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/16S_SILVA132_k2db --output WHOI020_16S_TCGACGAG_70m_taxonomy --report 70m.kreport WHOI020_16S_TCGACGAG_70m_merged.fasta\
Loading database information... done.\
39382 sequences (11.08 Mbp) processed in 1.203s (1963.6 Kseq/m, 552.67 Mbp/m).\
 \cb6  39201 sequences classified (99.54%)\
  181 sequences unclassified (0.46%)\cb1 \
(kraken2) [selkassas@poseidon-l2 original_merged_fasta_files]$ kraken2 --db /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/16S_SILVA132_k2db --output WHOI010_16S_AGAGTCAC_380m_taxonomy --report 380m.kreport WHOI010_16S_AGAGTCAC_380m_merged.fasta\
Loading database information... done.\
40210 sequences (11.42 Mbp) processed in 1.252s (1927.5 Kseq/m, 547.66 Mbp/m).\
  \cb6 40061 sequences classified (99.63%)\
  149 sequences unclassified (0.37%)\cb1 \
(kraken2) [selkassas@poseidon-l2 original_merged_fasta_files]$ \cb3 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 \cf4 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs36 \cf0 \cb1 \CocoaLigature1 \
Classifying 18S using FASTA36
\fs26 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b0\fs32 \cf4 \cb5 \expnd0\expndtw0\kerning0
Programs used: fq2fa 1.1.3, FASTA36 36.3.8e
\fs26 \cf0 \cb1 \kerning1\expnd0\expndtw0 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \
Got the Protist Ribosomal Reference db v 4.11.1 from https://github.com/pr2database/pr2database/releases/tag/4.11.1\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \cb3 \
wget https://github.com/pr2database/pr2database/releases/download/4.11.1/pr2_version_4.11.1_merged.tsv.gz\
wget https://github.com/pr2database/pr2database/releases/download/4.11.1/pr2_version_4.11.1_metadata.tsv.gz\
wget https://github.com/pr2database/pr2database/releases/download/4.11.1/pr2_version_4.11.1_taxo_long.fasta.gz\
\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\b \cf0 NOTE: the dinoREF db is already attached to the Protist Ribosomal Reference db as of version 4.9.9. 
\f1\b0 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \cb7 \
Got the DinoREF db from 
\f3\fs22 \cf2 \cb1 \CocoaLigature0 https://figshare.com/ndownloader/articles/5568454/versions/2 anyways\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cb3 \
wget https://figshare.com/ndownloader/articles/5568454/versions/2\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cb7 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 First, merge forward and reverse reads and convert to fasta using fq2fa 
\f2\b \cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b0 \cf8 \cb3 \
\pard\pardeftab720\sl380\partightenfactor0
\cf4 fq2fa --merge --filter 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI021-V9_S105_L001_R1_001_val_1.fq WHOI021-V9_S105_L001_R2_001_val_2.fq WHOI021-V9_S105_L001
\f1\fs24 _40m_merged.fasta\expnd0\expndtw0\kerning0
\CocoaLigature1 \
fq2fa --merge --filter 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI040-V9_S124_L001_R1_001_val_1.fq WHOI040-V9_S124_L001_R2_001_val_2.fq WHOI040-V9_S124_L001
\f1\fs24 _70m_merged.fasta\expnd0\expndtw0\kerning0
\CocoaLigature1 \
fq2fa --merge --filter 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI010-V9_S94_L001_R1_001_val_1.fq
\f1\fs24  
\f3\fs22 WHOI010-V9_S94_L001_R2_001_val_2.fq
\f1\fs24  
\f3\fs22 WHOI010-V9_S94_L001
\f1\fs24 _380m_merged.fasta\cf8 \expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f2\b \cf4 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f3\b0 \cf2 \cb7 \kerning1\expnd0\expndtw0 \CocoaLigature0 \
fasta36, 18S code\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0

\fs22 \cf4 \cb3 #!/bin/bash\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 #SBATCH --partition=compute                          # Queue selection\
#SBATCH --job-name=fasta36_18S2                       # Job name\
#SBATCH --mail-type=ALL                              # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=selkassas@whoi.edu               # Where to send mail\
#SBATCH --ntasks=1                                   # Run a single task\
#SBATCH --cpus-per-task=36                           # Number of CPU cores per task\
#SBATCH --mem=180gb                                  # Job memory request\
#SBATCH --time=24:00:00                              # Time limit hrs:min:sec\
#SBATCH --output=fasta36_18S%j.log                   # Standard output/error\
\
export OMP_NUM_THREADS=36\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\kerning1\expnd0\expndtw0 \CocoaLigature0 \
module load anaconda/5.1\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 source activate fasta36\
\
cd \kerning1\expnd0\expndtw0 \CocoaLigature0 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/18S_reads/trimmed_18S\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0  WHOI021-V9_S105_L001_40m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/Protist_Ribosomal_reference_db_18S/pr2_version_4.11.1_taxo_long.fasta > WHOI021-V9_S105_L001_40m_18S_taxonomy\
Submitted batch job 1726141\
\

\f1\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0  WHOI040-V9_S124_L001_70m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/Protist_Ribosomal_reference_db_18S/pr2_version_4.11.1_taxo_long.fasta > WHOI040-V9_S124_L001_70m_18S_taxonomy\
\
Submitted batch job 1726143\
\

\f1\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0  WHOI010-V9_S94_L001_380m_merged.fasta /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/Protist_Ribosomal_reference_db_18S/pr2_version_4.11.1_taxo_long.fasta > WHOI010-V9_S94_L001_380m_18S_taxonomy\
\
Submitted batch job 1726145\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 \cf2 \kerning1\expnd0\expndtw0 \CocoaLigature0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs22 Submitted batch job 1434716 \'97SUCCESS but no matches 
\fs24 \
\
BUT NO HITS WITH E < 15. Changing the threshold of E to 50. Default E value is 10. Ended up using the default. \

\fs22 Submitted batch job 1726112
\fs24  - FAILED -b flag is deprecated\

\fs22 Submitted batch job 1726117 - Success but no matches\
Submitted batch job 1726124 - pinpointed fasta file this time.\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cb6 Failed, but files were generated?
\fs24 \cb7 \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs36 \cf0 \cb1 \CocoaLigature1 Separating out Eukaryotic 16S rRNA plastid sequences using FASTA36 (or Diamond if FASTA36 does not work)
\fs26 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97
\f3\b0\fs24 \cf2 \cb7 \CocoaLigature0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs36 \cb5 Programs used: FASTA36, Protist Ribosomal Reference DB 
\f1\b0 \cf0 \CocoaLigature1 v 4.14.1 with PhytoREF already included
\f0\b\fs26 \cf2 \cb7 \CocoaLigature0 \
\
From the paper: \
\pard\pardeftab720\sl260\sa240\partightenfactor0

\f1\b0 \cf4 \cb1 \expnd0\expndtw0\kerning0
\CocoaLigature1 \'93Eukaryotic 16S rRNA plastid sequences were separated from the prokaryotic 16S rRNA fraction by searching against phytoREF release 1, a database containing aquatic and terrestrial plastid representatives from major eukaryotic lineages\cf18 \up5 \'94\cf4 \up0  \
- No program was provided for this, so using FASTA36 again since it \'93fasta36 - scans a protein or DNA sequence library for similar sequences\'94 and was already used in the paper. It should work for this function, since it is essentially what we were doing before anyways. \
-Downloaded PR2 4.14.1 to get phytoREF and :plast on taxonomy..\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab720\pardirnatural\partightenfactor0

\f3\fs22 \cf4 \cb3 \kerning1\expnd0\expndtw0 \CocoaLigature0 #!/bin/bash\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 #SBATCH --partition=compute                          # Queue selection\
#SBATCH --job-name=fasta36_plastids                  # Job name\
#SBATCH --mail-type=ALL                              # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=selkassas@whoi.edu               # Where to send mail\
#SBATCH --ntasks=1                                   # Run a single task\
#SBATCH --cpus-per-task=36                           # Number of CPU cores per task\
#SBATCH --mem=180gb                                  # Job memory request\
#SBATCH --time=24:00:00                              # Time limit hrs:min:sec\
#SBATCH --output=fasta36_plastids%j.log              # Standard output/error\
\
export OMP_NUM_THREADS=36\expnd0\expndtw0\kerning0
\CocoaLigature1 \
\kerning1\expnd0\expndtw0 \CocoaLigature0 \
module load anaconda/5.1\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 source activate fasta36\cf2 \kerning1\expnd0\expndtw0 \CocoaLigature0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0
\cf4 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 fasta36 -U
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0  WHOI040_16S_TCGACGAG_40m_merged.fasta \cf2 \cb1 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/Protist_Ribosomal_reference_db_18S/\cf9 pr2_version_4.14.0_SSU_taxo_long.fasta\cf4 \cb3  > WHOI040_16S_TCGACGAG_40m_plastids_4.14.0\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardeftab720\pardirnatural\partightenfactor0

\f1\fs24 \cf4 \expnd0\expndtw0\kerning0
\CocoaLigature1 fasta36 -U
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0  WHOI020_16S_TCGACGAG_70m_merged.fasta \cf2 \cb1 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/Protist_Ribosomal_reference_db_18S/\cf9 pr2_version_4.14.0_SSU_taxo_long.fasta\cf4 \cb3  > WHOI020_16S_TCGACGAG_70m_plastids_4.14.0\
\

\f1\fs24 \expnd0\expndtw0\kerning0
\CocoaLigature1 fasta36 -U 
\f3\fs22 \kerning1\expnd0\expndtw0 \CocoaLigature0 WHOI010_16S_AGAGTCAC_380m_merged.fasta \cf2 \cb1 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/Protist_Ribosomal_reference_db_18S/\cf9 pr2_version_4.14.0_SSU_taxo_long.fasta\cf4 \cb3   > WHOI010_16S_AGAGTCAC_380m_plastids_4.14.0\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 Submitted batch job 1726150 - 4.11.1\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf2 \cb1 Submitted batch job 1746989 - 4.14.1\
Submitted batch job 1748457\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \cb3 Submitted batch job 1726151 - 4.11.1\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf2 \cb1 Submitted batch job 1746994 - 4.14.1\
Submitted batch job 1748465\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf4 \cb3 Submitted batch job 1726154 - 4.11.1\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf2 \cb1 Submitted batch job 1746997 - 4.14.1\
Submitted batch job 1748467\cf4 \cb3 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\fs26 \cf2 \cb7 \
\cb6 It all failed but somehow did classify?\cb7 \

\f3 \
Tried to get the phytoREF database, but it is now a part of the Protist Ribosomal Reference DB 2. See below:\
\
\pard\pardeftab720\sl360\partightenfactor0

\f0\b\fs28 \cf19 \expnd0\expndtw0\kerning0
\CocoaLigature1 Please note that the PhytoREF database has been now integrated into the PR2 database. Please use the files provided in the latest release (labelled 16S).
\f1\b0 \
\
{\field{\*\fldinst{HYPERLINK "https://github.com/pr2database/pr2database/releases"}}{\fldrslt https://github.com/pr2database/pr2database/releases}}\
---\
The PhytoREF data- base that contains plastidial 16S rDNA reference sequences that originate from a large diversity of eukaryotes representing all known major photosynthetic lineages. Stringent quality filtering and a phylogeny-based taxonomic classifica- tion were applied for each 16S rDNA sequence. The database mainly focuses on marine microalgae, but sequences from land plants (representing half of the PhytoREF sequences) and freshwater taxa were also included to broaden the applicability of PhytoREF to different aquatic and terrestrial habitats.\
PhytoREF is a new resource in molecular ecology to foster the discovery, assessment and monitoring of the diversity of photosynthetic eukaryotes using high-throughput sequencing.
\f3\fs24 \cf2 \kerning1\expnd0\expndtw0 \CocoaLigature0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\
Already have the PR in the databases folder, version
\f1\fs26 \cf0 \cb1 \CocoaLigature1  4.11.1
\f3\fs24 \cf2 \cb7 \CocoaLigature0 \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cb6 Will have to filter the file by :plas for plastid sequences. they will be appended to the taxonomy in the file. \cb7 \
\
Commands to filter by \'93|plastid|\'94\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs22 \cb3 \
grep -E "\\|plastid\\|" WHOI040_16S_TCGACGAG_40m_plastids_4.14.0 > WHOI040_16S_TCGACGAG_40m_plastids_only\
grep -E "\\|plastid\\|" WHOI020_16S_TCGACGAG_70m_plastids_4.14.0 > WHOI020_16S_TCGACGAG_70m_plastids_only\
grep -E "\\|plastid\\|" WHOI010_16S_AGAGTCAC_380m_plastids_4.14.0 > WHOI010_16S_AGAGTCAC_380m_plastids_only\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 \cb7 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs36 \cf0 \cb1 \CocoaLigature1 Redoing kraken2 using \'97paired option and \'97use-names \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f3\b0\fs22 \cf2 \cb3 \CocoaLigature0 #!/bin/bash\
#SBATCH --partition=scavenger            # Queue selection\
#SBATCH --job-name=kraken2               # Job name\
#SBATCH --mail-type=ALL                  # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=kaabbott@whoi.edu   # Where to send mail\
#SBATCH --ntasks=1                       # Run a single task\
#SBATCH --cpus-per-task=36               # Number of CPU cores per task\
#SBATCH --mem=180gb                      # Job memory request\
#SBATCH --time=24:00:00                  # Time limit hrs:min:sec\
#SBATCH --output=kraken2_paired.log             # Standard output/error\
#export OMP_NUM_THREADS=36\
\
module load anaconda/5.1\
source activate kraken2\
\
#40m, SSU\
kraken2 --db /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/16S_SILVA132_k2db/kraken_silva --output WHOI040_16S_TCGACGAG_40m_taxonomy --report 40m.kreport --paired /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/WHOI040_16S_TCGACGAG_R1_val_1.fq /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/WHOI040_16S_TCGACGAG_R2_val_2.fq\
\
#70m, SSU\
kraken2 --db /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/16S_SILVA132_k2db/kraken_silva --output WHOI020_16S_TCGACGAG_70m_taxonomy --report 70m.kreport --paired /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/WHOI020_16S_TCGACGAG_R1_val_1.fq /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/WHOI020_16S_TCGACGAG_R2_val_2.fq\
\
#380m, SSU\
kraken2 --db /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/16S_SILVA132_k2db/kraken_silva --output WHOI010_16S_AGAGTCAC_380m_taxonomy --report 380m.kreport --paired /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/WHOI010_16S_AGAGTCAC_R1_val_1.fq /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/WHOI010_16S_AGAGTCAC_R2_val_2.fq\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 \cb7 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs36 \cf0 \cb1 \CocoaLigature1 Subsample 16S sequences from ~20000 paired-end reads to ~6000 paired-end reads after running kraken2 classification (to make analysis of output easier)\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs26 \cf0 From the paper:\
\pard\pardeftab720\partightenfactor0

\f1\b0 \cf20 \cb12 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec20 \'93A modest number of sequences was generated to capture the dominant microbial community members since deep sequencing of the rare biosphere was not the intended goal. An average of 2,500 post-processed sequences per sample were generated for 18S rRNA, 6,000 for 16S rRNA (non-plastid) and 144 for 16S rRNA plastid fractions corresponding to approximately 3,100 18S rRNA, 4,800 16S rRNA (non-plastid) and 200 16S rRNA plastid OTUs (Supplementary Table\'a0{\field{\*\fldinst{HYPERLINK "https://www.nature.com/articles/s41564-020-00814-7#MOESM7"}}{\fldrslt \cf21 \ul \ulc21 \strokec21 5}}).\'94
\f3\fs24 \
\
Note that once we have classification of plastids from 16S output, will probably want to remove those sequences from the kraken2 output before doing the subsampling, but keeping this workflow in here.
\f0\b\fs26 \cf0 \cb1 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97\'97
\f3\b0\fs24 \cf2 \cb7 \CocoaLigature0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs22 \cb3 \
sample_number=2500\
\
for file in WHOI010_16S_AGAGTCAC_380m_taxonomy WHOI020_16S_TCGACGAG_70m_taxonomy WHOI040_16S_TCGACGAG_40m_taxonomy   \
do\
	shuf -n $sample_number $file > $\{file\}_subsample_$\{sample_number\}_seqs\
done\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 \cb7 \
We want to use KrakenTools to generate a kraken report from the subsampled output (since the original report is valid for all samples)\
First, use make_ktaxonomy.py, then make_kreport.py\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs22 \cb3 \
srun -p compute --ntasks-per-node=1 --time=02:00:00 --mem=10G --pty bash\
\
script_dir=/vortexfs1/home/kaabbott/.conda/pkgs/krakentools-1.2-pyh5e36f6f_0/python-scripts\
database_dir=/vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/16S_SILVA132_k2db/kraken_silva\
\
python $\{script_dir\}/make_ktaxonomy.py --nodes $\{database_dir\}/taxonomy/nodes.dmp --names $\{database_dir\}/taxonomy/names.dmp --seqid2taxid $\{database_dir\}/seqid2taxid.map -o $\{database_dir\}/16S_SILVA132_taxonomy_file\
\
for taxonomy in WHOI*_subsample_2500_seqs\
do\
\pard\pardeftab720\partightenfactor0
	python $\{script_dir\}/make_kreport.py -i $taxonomy -t $\{database_dir\}/16S_SILVA132_taxonomy_file -o $\{taxonomy\}_report\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
done\
\
mv WHOI040_16S_TCGACGAG_40m_taxonomy_subsample_2500_seqs_report 40m_subsample_2500.kreport\
mv WHOI020_16S_TCGACGAG_70m_taxonomy_subsample_2500_seqs_report 70m_subsample_2500.kreport\
mv WHOI010_16S_AGAGTCAC_380m_taxonomy_subsample_2500_seqs_report 380m_subsample_2500.kreport\
\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 \cb7 \
Running Bracken to get abundance tables at phylum level, see this blog post: https://microbe.net/2017/04/27/why-use-bracken-instead-of-kraken/\
\
\cb22 #First, need the read length. Try using minimum read length for sequences from each sample? \
\
for file in WHOI010_16S_AGAGTCAC WHOI020_16S_TCGACGAG WHOI040_16S_TCGACGAG\
do\
	echo $file\
	grep -E -A1 "M00436" $\{file\}_R1_val_1.fq | grep -v "M00436" | awk '\{ print length \}' | sort -n | awk '$1 > 2' | sort -n | head -n1\
	grep -E -A1 "M00436" $\{file\}_R2_val_2.fq | grep -v "M00436" | awk '\{ print length \}' | sort -n | awk '$1 > 2' | sort -n | head -n1\
done\
\
WHOI010_16S_AGAGTCAC\
25\
18\
WHOI020_16S_TCGACGAG\
25\
18\
WHOI040_16S_TCGACGAG\
28\
18\
\
so read length is the min bp length, which is 18 - https://github.com/jenniferlu717/Bracken/issues/30\
\
## Generate Bracken database file\
\
srun -p compute --ntasks-per-node=10 --time=02:00:00 --mem=10G --pty bash\
conda activate kraken2\
\
bracken-build -d 
\fs22 \cb3 /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/16S_SILVA132_k2db/kraken_silva -t 10 -k 35 -l 150
\fs24 \cb22 \
\
\cb7 \
\
\
\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs22 \cb3 #!/bin/bash\
#SBATCH --partition=scavenger            # Queue selection\
#SBATCH --job-name=bracken               # Job name\
#SBATCH --mail-type=ALL                  # Mail events (BEGIN, END, FAIL, ALL)\
#SBATCH --mail-user=kaabbott@whoi.edu   # Where to send mail\
#SBATCH --ntasks=1                       # Run a single task\
#SBATCH --cpus-per-task=36               # Number of CPU cores per task\
#SBATCH --mem=180gb                      # Job memory request\
#SBATCH --time=24:00:00                  # Time limit hrs:min:sec\
#SBATCH --output=bracken.log             # Standard output/error\
#export OMP_NUM_THREADS=36\
\
module load anaconda/5.1\
source activate kraken2\
\
taxonomy_dir=/vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/data/16S_reads/trimmed_16S/kraken_taxonomy\
read_len=150\
level=P\
\
for sample in 40m 70m 380m\
do\
	bracken -d /vortexfs1/omics/env-bio/collaboration/dinoflagellates_METZYME/databases/silva111/16S_SILVA132_k2db/kraken_silva -i $\{taxonomy_dir\}/$\{sample\}_subsample_2500.kreport -o $\{sample\}.bracken -r $read_len -l $level\
done\
\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\fs24 \cb7 \
\
\
\
\
\
\
\
to do: \
filter for plastid sequences - done\
subsample 16S and 18S\
diamond blastP for metaT - done\
lineage probability index\
download PR 4.14.1 with plast added - done\
\
\
\
\
}